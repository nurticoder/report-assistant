"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/analyze/route";
exports.ids = ["app/api/analyze/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "rimraf":
/*!*************************!*\
  !*** external "rimraf" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("rimraf");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "constants":
/*!****************************!*\
  !*** external "constants" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("constants");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_1_Downloads_Report_Assistant_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/analyze/route.ts */ \"(rsc)/./app/api/analyze/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/analyze/route\",\n        pathname: \"/api/analyze\",\n        filename: \"route\",\n        bundlePath: \"app/api/analyze/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\1\\\\Downloads\\\\Report Assistant\\\\app\\\\api\\\\analyze\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_1_Downloads_Report_Assistant_app_api_analyze_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/analyze/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhbmFseXplJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhbmFseXplJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYW5hbHl6ZSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUMxJTVDRG93bmxvYWRzJTVDUmVwb3J0JTIwQXNzaXN0YW50JTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUMxJTVDRG93bmxvYWRzJTVDUmVwb3J0JTIwQXNzaXN0YW50JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNzQjtBQUNuRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3JlcG9ydC1hc3Npc3RhbnQvPzMwYTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcMVxcXFxEb3dubG9hZHNcXFxcUmVwb3J0IEFzc2lzdGFudFxcXFxhcHBcXFxcYXBpXFxcXGFuYWx5emVcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FuYWx5emUvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hbmFseXplXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hbmFseXplL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcMVxcXFxEb3dubG9hZHNcXFxcUmVwb3J0IEFzc2lzdGFudFxcXFxhcHBcXFxcYXBpXFxcXGFuYWx5emVcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FuYWx5emUvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/analyze/route.ts":
/*!**********************************!*\
  !*** ./app/api/analyze/route.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_analyze__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/analyze */ \"(rsc)/./lib/analyze.ts\");\n/* harmony import */ var _lib_excel__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/excel */ \"(rsc)/./lib/excel.ts\");\n\n\n\nconst runtime = \"nodejs\";\nasync function POST(req) {\n    try {\n        const formData = await req.formData();\n        const wordFile = formData.get(\"word\");\n        const excelFile = formData.get(\"excel\");\n        const monthOverride = formData.get(\"monthOverride\");\n        const mappingOverrideRaw = formData.get(\"mappingOverride\");\n        if (!wordFile || !excelFile) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Missing Word or Excel file.\"\n            }, {\n                status: 400\n            });\n        }\n        const [wordBuffer, excelBuffer] = await Promise.all([\n            wordFile.arrayBuffer(),\n            excelFile.arrayBuffer()\n        ]);\n        const mappingOverride = mappingOverrideRaw ? JSON.parse(mappingOverrideRaw) : null;\n        const excelRisks = await (0,_lib_excel__WEBPACK_IMPORTED_MODULE_2__.detectExcelRisks)(excelBuffer, excelFile.name);\n        const { response } = await (0,_lib_analyze__WEBPACK_IMPORTED_MODULE_1__.analyzeReport)({\n            wordBuffer,\n            wordFilename: wordFile.name,\n            monthOverride,\n            mappingOverride\n        });\n        if (excelRisks.length > 0) {\n            response.validations.push({\n                id: \"excel-risk\",\n                status: \"fail\",\n                message: \"Excel file contains unsupported features. Generation blocked.\",\n                details: excelRisks.join(\" \")\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n    } catch (error) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message ?? \"Analyze failed.\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FuYWx5emUvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDRztBQUNDO0FBRXhDLE1BQU1HLFVBQVUsU0FBUztBQUV6QixlQUFlQyxLQUFLQyxHQUFZO0lBQ3JDLElBQUk7UUFDRixNQUFNQyxXQUFXLE1BQU1ELElBQUlDLFFBQVE7UUFDbkMsTUFBTUMsV0FBV0QsU0FBU0UsR0FBRyxDQUFDO1FBQzlCLE1BQU1DLFlBQVlILFNBQVNFLEdBQUcsQ0FBQztRQUMvQixNQUFNRSxnQkFBZ0JKLFNBQVNFLEdBQUcsQ0FBQztRQUNuQyxNQUFNRyxxQkFBcUJMLFNBQVNFLEdBQUcsQ0FBQztRQUV4QyxJQUFJLENBQUNELFlBQVksQ0FBQ0UsV0FBVztZQUMzQixPQUFPVCxxREFBWUEsQ0FBQ1ksSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQThCLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNuRjtRQUVBLE1BQU0sQ0FBQ0MsWUFBWUMsWUFBWSxHQUFHLE1BQU1DLFFBQVFDLEdBQUcsQ0FBQztZQUNsRFgsU0FBU1ksV0FBVztZQUNwQlYsVUFBVVUsV0FBVztTQUN0QjtRQUVELE1BQU1DLGtCQUFrQlQscUJBQXFCVSxLQUFLQyxLQUFLLENBQUNYLHNCQUFzQjtRQUU5RSxNQUFNWSxhQUFhLE1BQU1yQiw0REFBZ0JBLENBQUNjLGFBQWFQLFVBQVVlLElBQUk7UUFFckUsTUFBTSxFQUFFQyxRQUFRLEVBQUUsR0FBRyxNQUFNeEIsMkRBQWFBLENBQUM7WUFDdkNjO1lBQ0FXLGNBQWNuQixTQUFTaUIsSUFBSTtZQUMzQmQ7WUFDQVU7UUFDRjtRQUVBLElBQUlHLFdBQVdJLE1BQU0sR0FBRyxHQUFHO1lBQ3pCRixTQUFTRyxXQUFXLENBQUNDLElBQUksQ0FBQztnQkFDeEJDLElBQUk7Z0JBQ0poQixRQUFRO2dCQUNSaUIsU0FBUztnQkFDVEMsU0FBU1QsV0FBV1UsSUFBSSxDQUFDO1lBQzNCO1FBQ0Y7UUFFQSxPQUFPakMscURBQVlBLENBQUNZLElBQUksQ0FBQ2E7SUFDM0IsRUFBRSxPQUFPWixPQUFZO1FBQ25CLE9BQU9iLHFEQUFZQSxDQUFDWSxJQUFJLENBQUM7WUFBRUMsT0FBT0EsTUFBTWtCLE9BQU8sSUFBSTtRQUFrQixHQUFHO1lBQUVqQixRQUFRO1FBQUk7SUFDeEY7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlcG9ydC1hc3Npc3RhbnQvLi9hcHAvYXBpL2FuYWx5emUvcm91dGUudHM/NDZiYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBhbmFseXplUmVwb3J0IH0gZnJvbSAnQC9saWIvYW5hbHl6ZSc7XG5pbXBvcnQgeyBkZXRlY3RFeGNlbFJpc2tzIH0gZnJvbSAnQC9saWIvZXhjZWwnO1xuXG5leHBvcnQgY29uc3QgcnVudGltZSA9ICdub2RlanMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBmb3JtRGF0YSA9IGF3YWl0IHJlcS5mb3JtRGF0YSgpO1xuICAgIGNvbnN0IHdvcmRGaWxlID0gZm9ybURhdGEuZ2V0KCd3b3JkJykgYXMgRmlsZSB8IG51bGw7XG4gICAgY29uc3QgZXhjZWxGaWxlID0gZm9ybURhdGEuZ2V0KCdleGNlbCcpIGFzIEZpbGUgfCBudWxsO1xuICAgIGNvbnN0IG1vbnRoT3ZlcnJpZGUgPSBmb3JtRGF0YS5nZXQoJ21vbnRoT3ZlcnJpZGUnKSBhcyBzdHJpbmcgfCBudWxsO1xuICAgIGNvbnN0IG1hcHBpbmdPdmVycmlkZVJhdyA9IGZvcm1EYXRhLmdldCgnbWFwcGluZ092ZXJyaWRlJykgYXMgc3RyaW5nIHwgbnVsbDtcblxuICAgIGlmICghd29yZEZpbGUgfHwgIWV4Y2VsRmlsZSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdNaXNzaW5nIFdvcmQgb3IgRXhjZWwgZmlsZS4nIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgW3dvcmRCdWZmZXIsIGV4Y2VsQnVmZmVyXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIHdvcmRGaWxlLmFycmF5QnVmZmVyKCksXG4gICAgICBleGNlbEZpbGUuYXJyYXlCdWZmZXIoKVxuICAgIF0pO1xuXG4gICAgY29uc3QgbWFwcGluZ092ZXJyaWRlID0gbWFwcGluZ092ZXJyaWRlUmF3ID8gSlNPTi5wYXJzZShtYXBwaW5nT3ZlcnJpZGVSYXcpIDogbnVsbDtcblxuICAgIGNvbnN0IGV4Y2VsUmlza3MgPSBhd2FpdCBkZXRlY3RFeGNlbFJpc2tzKGV4Y2VsQnVmZmVyLCBleGNlbEZpbGUubmFtZSk7XG5cbiAgICBjb25zdCB7IHJlc3BvbnNlIH0gPSBhd2FpdCBhbmFseXplUmVwb3J0KHtcbiAgICAgIHdvcmRCdWZmZXIsXG4gICAgICB3b3JkRmlsZW5hbWU6IHdvcmRGaWxlLm5hbWUsXG4gICAgICBtb250aE92ZXJyaWRlLFxuICAgICAgbWFwcGluZ092ZXJyaWRlXG4gICAgfSk7XG5cbiAgICBpZiAoZXhjZWxSaXNrcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXNwb25zZS52YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgaWQ6ICdleGNlbC1yaXNrJyxcbiAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgIG1lc3NhZ2U6ICdFeGNlbCBmaWxlIGNvbnRhaW5zIHVuc3VwcG9ydGVkIGZlYXR1cmVzLiBHZW5lcmF0aW9uIGJsb2NrZWQuJyxcbiAgICAgICAgZGV0YWlsczogZXhjZWxSaXNrcy5qb2luKCcgJylcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSk7XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSA/PyAnQW5hbHl6ZSBmYWlsZWQuJyB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XHJcblxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiYW5hbHl6ZVJlcG9ydCIsImRldGVjdEV4Y2VsUmlza3MiLCJydW50aW1lIiwiUE9TVCIsInJlcSIsImZvcm1EYXRhIiwid29yZEZpbGUiLCJnZXQiLCJleGNlbEZpbGUiLCJtb250aE92ZXJyaWRlIiwibWFwcGluZ092ZXJyaWRlUmF3IiwianNvbiIsImVycm9yIiwic3RhdHVzIiwid29yZEJ1ZmZlciIsImV4Y2VsQnVmZmVyIiwiUHJvbWlzZSIsImFsbCIsImFycmF5QnVmZmVyIiwibWFwcGluZ092ZXJyaWRlIiwiSlNPTiIsInBhcnNlIiwiZXhjZWxSaXNrcyIsIm5hbWUiLCJyZXNwb25zZSIsIndvcmRGaWxlbmFtZSIsImxlbmd0aCIsInZhbGlkYXRpb25zIiwicHVzaCIsImlkIiwibWVzc2FnZSIsImRldGFpbHMiLCJqb2luIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/analyze/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/analyze.ts":
/*!************************!*\
  !*** ./lib/analyze.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   analyzeReport: () => (/* binding */ analyzeReport)\n/* harmony export */ });\n/* harmony import */ var _lib_docx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/docx */ \"(rsc)/./lib/docx.ts\");\n/* harmony import */ var _lib_metrics__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/metrics */ \"(rsc)/./lib/metrics.ts\");\n/* harmony import */ var _lib_cases__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/cases */ \"(rsc)/./lib/cases.ts\");\n/* harmony import */ var _lib_month__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/month */ \"(rsc)/./lib/month.ts\");\n/* harmony import */ var _lib_validate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/validate */ \"(rsc)/./lib/validate.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./lib/config.ts\");\n\n\n\n\n\n\nasync function analyzeReport(params) {\n    const { wordBuffer, wordFilename, monthOverride, mappingOverride } = params;\n    const [dictionary, requiredMetrics, metricRules, crossChecks, caseFieldMap, caseRules, carryOverRules] = await Promise.all([\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getMetricDictionary)(),\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getRequiredMetrics)(),\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getMetricRules)(),\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getCrossChecks)(),\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getCaseFieldMap)(),\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getCaseRules)(),\n        (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getCarryOverRules)()\n    ]);\n    const metricCellMap = mappingOverride && Object.keys(mappingOverride).length > 0 ? {\n        ...await (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getMetricCellMap)(),\n        ...mappingOverride\n    } : await (0,_lib_config__WEBPACK_IMPORTED_MODULE_5__.getMetricCellMap)();\n    const parsedDocx = await (0,_lib_docx__WEBPACK_IMPORTED_MODULE_0__.parseDocx)(wordBuffer);\n    const { metrics, duplicates } = (0,_lib_metrics__WEBPACK_IMPORTED_MODULE_1__.extractMetrics)(parsedDocx.paragraphs, parsedDocx.tables, dictionary);\n    const cases = (0,_lib_cases__WEBPACK_IMPORTED_MODULE_2__.extractCaseRows)(parsedDocx.tables, caseFieldMap);\n    const monthInfo = (0,_lib_month__WEBPACK_IMPORTED_MODULE_3__.detectMonth)(parsedDocx.paragraphs, wordFilename);\n    const { validations, resolvedMonth, canGenerate } = (0,_lib_validate__WEBPACK_IMPORTED_MODULE_4__.validateAnalysis)({\n        metrics,\n        cases,\n        requiredMetrics,\n        metricCellMap,\n        metricRules,\n        crossChecks,\n        caseRules,\n        monthCandidates: monthInfo.candidates,\n        monthOverride,\n        duplicateMetrics: duplicates,\n        carryOverRules\n    });\n    const response = {\n        month: resolvedMonth,\n        metrics,\n        casesPreview: cases.slice(0, 50),\n        validations\n    };\n    return {\n        response,\n        canGenerate,\n        metricCellMap,\n        requiredMetrics,\n        cases\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYW5hbHl6ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXVDO0FBQ1E7QUFDRDtBQUNKO0FBQ1E7QUFVNUI7QUFHZixlQUFlYSxjQUFjQyxNQUtuQztJQUNDLE1BQU0sRUFBRUMsVUFBVSxFQUFFQyxZQUFZLEVBQUVDLGFBQWEsRUFBRUMsZUFBZSxFQUFFLEdBQUdKO0lBRXJFLE1BQU0sQ0FBQ0ssWUFBWUMsaUJBQWlCQyxhQUFhQyxhQUFhQyxjQUFjQyxXQUFXQyxlQUFlLEdBQUcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDO1FBQ3pIakIsZ0VBQW1CQTtRQUNuQkUsK0RBQWtCQTtRQUNsQkQsMkRBQWNBO1FBQ2RILDJEQUFjQTtRQUNkRiw0REFBZUE7UUFDZkMseURBQVlBO1FBQ1pGLDhEQUFpQkE7S0FDbEI7SUFFRCxNQUFNdUIsZ0JBQWdCVixtQkFBbUJXLE9BQU9DLElBQUksQ0FBQ1osaUJBQWlCYSxNQUFNLEdBQUcsSUFDM0U7UUFBRSxHQUFJLE1BQU10Qiw2REFBZ0JBLEVBQUU7UUFBRyxHQUFHUyxlQUFlO0lBQUMsSUFDcEQsTUFBTVQsNkRBQWdCQTtJQUUxQixNQUFNdUIsYUFBYSxNQUFNaEMsb0RBQVNBLENBQUNlO0lBQ25DLE1BQU0sRUFBRWtCLE9BQU8sRUFBRUMsVUFBVSxFQUFFLEdBQUdqQyw0REFBY0EsQ0FBQytCLFdBQVdHLFVBQVUsRUFBRUgsV0FBV0ksTUFBTSxFQUFFakI7SUFDekYsTUFBTWtCLFFBQVFuQywyREFBZUEsQ0FBQzhCLFdBQVdJLE1BQU0sRUFBRWI7SUFDakQsTUFBTWUsWUFBWW5DLHVEQUFXQSxDQUFDNkIsV0FBV0csVUFBVSxFQUFFbkI7SUFFckQsTUFBTSxFQUFFdUIsV0FBVyxFQUFFQyxhQUFhLEVBQUVDLFdBQVcsRUFBRSxHQUFHckMsK0RBQWdCQSxDQUFDO1FBQ25FNkI7UUFDQUk7UUFDQWpCO1FBQ0FRO1FBQ0FQO1FBQ0FDO1FBQ0FFO1FBQ0FrQixpQkFBaUJKLFVBQVVLLFVBQVU7UUFDckMxQjtRQUNBMkIsa0JBQWtCVjtRQUNsQlQ7SUFDRjtJQUVBLE1BQU1vQixXQUE0QjtRQUNoQ0MsT0FBT047UUFDUFA7UUFDQWMsY0FBY1YsTUFBTVcsS0FBSyxDQUFDLEdBQUc7UUFDN0JUO0lBQ0Y7SUFFQSxPQUFPO1FBQUVNO1FBQVVKO1FBQWFiO1FBQWVSO1FBQWlCaUI7SUFBTTtBQUN4RSIsInNvdXJjZXMiOlsid2VicGFjazovL3JlcG9ydC1hc3Npc3RhbnQvLi9saWIvYW5hbHl6ZS50cz9mMmU3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlRG9jeCB9IGZyb20gJ0AvbGliL2RvY3gnO1xuaW1wb3J0IHsgZXh0cmFjdE1ldHJpY3MgfSBmcm9tICdAL2xpYi9tZXRyaWNzJztcbmltcG9ydCB7IGV4dHJhY3RDYXNlUm93cyB9IGZyb20gJ0AvbGliL2Nhc2VzJztcbmltcG9ydCB7IGRldGVjdE1vbnRoIH0gZnJvbSAnQC9saWIvbW9udGgnO1xuaW1wb3J0IHsgdmFsaWRhdGVBbmFseXNpcyB9IGZyb20gJ0AvbGliL3ZhbGlkYXRlJztcbmltcG9ydCB7XG4gIGdldENhcnJ5T3ZlclJ1bGVzLFxuICBnZXRDYXNlRmllbGRNYXAsXG4gIGdldENhc2VSdWxlcyxcbiAgZ2V0Q3Jvc3NDaGVja3MsXG4gIGdldE1ldHJpY0NlbGxNYXAsXG4gIGdldE1ldHJpY0RpY3Rpb25hcnksXG4gIGdldE1ldHJpY1J1bGVzLFxuICBnZXRSZXF1aXJlZE1ldHJpY3Ncbn0gZnJvbSAnQC9saWIvY29uZmlnJztcbmltcG9ydCB0eXBlIHsgQW5hbHl6ZVJlc3BvbnNlIH0gZnJvbSAnQC9saWIvdHlwZXMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYW5hbHl6ZVJlcG9ydChwYXJhbXM6IHtcbiAgd29yZEJ1ZmZlcjogQXJyYXlCdWZmZXI7XG4gIHdvcmRGaWxlbmFtZT86IHN0cmluZztcbiAgbW9udGhPdmVycmlkZT86IHN0cmluZyB8IG51bGw7XG4gIG1hcHBpbmdPdmVycmlkZT86IFJlY29yZDxzdHJpbmcsIHsgc2hlZXQ6IHN0cmluZzsgY2VsbDogc3RyaW5nIH0+IHwgbnVsbDtcbn0pIHtcbiAgY29uc3QgeyB3b3JkQnVmZmVyLCB3b3JkRmlsZW5hbWUsIG1vbnRoT3ZlcnJpZGUsIG1hcHBpbmdPdmVycmlkZSB9ID0gcGFyYW1zO1xuXG4gIGNvbnN0IFtkaWN0aW9uYXJ5LCByZXF1aXJlZE1ldHJpY3MsIG1ldHJpY1J1bGVzLCBjcm9zc0NoZWNrcywgY2FzZUZpZWxkTWFwLCBjYXNlUnVsZXMsIGNhcnJ5T3ZlclJ1bGVzXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBnZXRNZXRyaWNEaWN0aW9uYXJ5KCksXG4gICAgZ2V0UmVxdWlyZWRNZXRyaWNzKCksXG4gICAgZ2V0TWV0cmljUnVsZXMoKSxcbiAgICBnZXRDcm9zc0NoZWNrcygpLFxuICAgIGdldENhc2VGaWVsZE1hcCgpLFxuICAgIGdldENhc2VSdWxlcygpLFxuICAgIGdldENhcnJ5T3ZlclJ1bGVzKClcbiAgXSk7XG5cbiAgY29uc3QgbWV0cmljQ2VsbE1hcCA9IG1hcHBpbmdPdmVycmlkZSAmJiBPYmplY3Qua2V5cyhtYXBwaW5nT3ZlcnJpZGUpLmxlbmd0aCA+IDBcbiAgICA/IHsgLi4uKGF3YWl0IGdldE1ldHJpY0NlbGxNYXAoKSksIC4uLm1hcHBpbmdPdmVycmlkZSB9XG4gICAgOiBhd2FpdCBnZXRNZXRyaWNDZWxsTWFwKCk7XG5cbiAgY29uc3QgcGFyc2VkRG9jeCA9IGF3YWl0IHBhcnNlRG9jeCh3b3JkQnVmZmVyKTtcbiAgY29uc3QgeyBtZXRyaWNzLCBkdXBsaWNhdGVzIH0gPSBleHRyYWN0TWV0cmljcyhwYXJzZWREb2N4LnBhcmFncmFwaHMsIHBhcnNlZERvY3gudGFibGVzLCBkaWN0aW9uYXJ5KTtcbiAgY29uc3QgY2FzZXMgPSBleHRyYWN0Q2FzZVJvd3MocGFyc2VkRG9jeC50YWJsZXMsIGNhc2VGaWVsZE1hcCk7XG4gIGNvbnN0IG1vbnRoSW5mbyA9IGRldGVjdE1vbnRoKHBhcnNlZERvY3gucGFyYWdyYXBocywgd29yZEZpbGVuYW1lKTtcblxuICBjb25zdCB7IHZhbGlkYXRpb25zLCByZXNvbHZlZE1vbnRoLCBjYW5HZW5lcmF0ZSB9ID0gdmFsaWRhdGVBbmFseXNpcyh7XG4gICAgbWV0cmljcyxcbiAgICBjYXNlcyxcbiAgICByZXF1aXJlZE1ldHJpY3MsXG4gICAgbWV0cmljQ2VsbE1hcCxcbiAgICBtZXRyaWNSdWxlcyxcbiAgICBjcm9zc0NoZWNrcyxcbiAgICBjYXNlUnVsZXMsXG4gICAgbW9udGhDYW5kaWRhdGVzOiBtb250aEluZm8uY2FuZGlkYXRlcyxcbiAgICBtb250aE92ZXJyaWRlLFxuICAgIGR1cGxpY2F0ZU1ldHJpY3M6IGR1cGxpY2F0ZXMsXG4gICAgY2FycnlPdmVyUnVsZXNcbiAgfSk7XG5cbiAgY29uc3QgcmVzcG9uc2U6IEFuYWx5emVSZXNwb25zZSA9IHtcbiAgICBtb250aDogcmVzb2x2ZWRNb250aCxcbiAgICBtZXRyaWNzLFxuICAgIGNhc2VzUHJldmlldzogY2FzZXMuc2xpY2UoMCwgNTApLFxuICAgIHZhbGlkYXRpb25zXG4gIH07XG5cbiAgcmV0dXJuIHsgcmVzcG9uc2UsIGNhbkdlbmVyYXRlLCBtZXRyaWNDZWxsTWFwLCByZXF1aXJlZE1ldHJpY3MsIGNhc2VzIH07XG59XG5cclxuIl0sIm5hbWVzIjpbInBhcnNlRG9jeCIsImV4dHJhY3RNZXRyaWNzIiwiZXh0cmFjdENhc2VSb3dzIiwiZGV0ZWN0TW9udGgiLCJ2YWxpZGF0ZUFuYWx5c2lzIiwiZ2V0Q2FycnlPdmVyUnVsZXMiLCJnZXRDYXNlRmllbGRNYXAiLCJnZXRDYXNlUnVsZXMiLCJnZXRDcm9zc0NoZWNrcyIsImdldE1ldHJpY0NlbGxNYXAiLCJnZXRNZXRyaWNEaWN0aW9uYXJ5IiwiZ2V0TWV0cmljUnVsZXMiLCJnZXRSZXF1aXJlZE1ldHJpY3MiLCJhbmFseXplUmVwb3J0IiwicGFyYW1zIiwid29yZEJ1ZmZlciIsIndvcmRGaWxlbmFtZSIsIm1vbnRoT3ZlcnJpZGUiLCJtYXBwaW5nT3ZlcnJpZGUiLCJkaWN0aW9uYXJ5IiwicmVxdWlyZWRNZXRyaWNzIiwibWV0cmljUnVsZXMiLCJjcm9zc0NoZWNrcyIsImNhc2VGaWVsZE1hcCIsImNhc2VSdWxlcyIsImNhcnJ5T3ZlclJ1bGVzIiwiUHJvbWlzZSIsImFsbCIsIm1ldHJpY0NlbGxNYXAiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwicGFyc2VkRG9jeCIsIm1ldHJpY3MiLCJkdXBsaWNhdGVzIiwicGFyYWdyYXBocyIsInRhYmxlcyIsImNhc2VzIiwibW9udGhJbmZvIiwidmFsaWRhdGlvbnMiLCJyZXNvbHZlZE1vbnRoIiwiY2FuR2VuZXJhdGUiLCJtb250aENhbmRpZGF0ZXMiLCJjYW5kaWRhdGVzIiwiZHVwbGljYXRlTWV0cmljcyIsInJlc3BvbnNlIiwibW9udGgiLCJjYXNlc1ByZXZpZXciLCJzbGljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/analyze.ts\n");

/***/ }),

/***/ "(rsc)/./lib/cases.ts":
/*!**********************!*\
  !*** ./lib/cases.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractCaseRows: () => (/* binding */ extractCaseRows)\n/* harmony export */ });\nfunction normalizeHeader(text) {\n    return text.replace(/\\s+/g, \" \").trim();\n}\nfunction extractCaseRows(tables, config) {\n    const results = [];\n    tables.forEach((table, tableIndex)=>{\n        if (table.rows.length < 2) return;\n        const headerRow = table.rows[0].map(normalizeHeader);\n        const mappedHeaders = headerRow.map((header)=>config.headerMap[header] || null);\n        const matchedCount = mappedHeaders.filter(Boolean).length;\n        if (matchedCount < 2) return;\n        table.rows.slice(1).forEach((row, rowOffset)=>{\n            if (row.every((cell)=>cell.trim().length === 0)) return;\n            const normalized = {};\n            row.forEach((cell, idx)=>{\n                const key = mappedHeaders[idx];\n                if (key) {\n                    normalized[key] = cell.trim();\n                }\n            });\n            results.push({\n                section: config.section,\n                normalized,\n                rawCells: row,\n                header: headerRow,\n                source: {\n                    tableIndex,\n                    row: rowOffset + 1\n                }\n            });\n        });\n    });\n    return results;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY2FzZXMudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUdBLFNBQVNBLGdCQUFnQkMsSUFBWTtJQUNuQyxPQUFPQSxLQUFLQyxPQUFPLENBQUMsUUFBUSxLQUFLQyxJQUFJO0FBQ3ZDO0FBRU8sU0FBU0MsZ0JBQWdCQyxNQUFtQixFQUFFQyxNQUE4RDtJQUNqSCxNQUFNQyxVQUEyQixFQUFFO0lBRW5DRixPQUFPRyxPQUFPLENBQUMsQ0FBQ0MsT0FBT0M7UUFDckIsSUFBSUQsTUFBTUUsSUFBSSxDQUFDQyxNQUFNLEdBQUcsR0FBRztRQUMzQixNQUFNQyxZQUFZSixNQUFNRSxJQUFJLENBQUMsRUFBRSxDQUFDRyxHQUFHLENBQUNkO1FBQ3BDLE1BQU1lLGdCQUFnQkYsVUFBVUMsR0FBRyxDQUFDLENBQUNFLFNBQVdWLE9BQU9XLFNBQVMsQ0FBQ0QsT0FBTyxJQUFJO1FBQzVFLE1BQU1FLGVBQWVILGNBQWNJLE1BQU0sQ0FBQ0MsU0FBU1IsTUFBTTtRQUN6RCxJQUFJTSxlQUFlLEdBQUc7UUFFdEJULE1BQU1FLElBQUksQ0FBQ1UsS0FBSyxDQUFDLEdBQUdiLE9BQU8sQ0FBQyxDQUFDYyxLQUFLQztZQUNoQyxJQUFJRCxJQUFJRSxLQUFLLENBQUMsQ0FBQ0MsT0FBU0EsS0FBS3RCLElBQUksR0FBR1MsTUFBTSxLQUFLLElBQUk7WUFDbkQsTUFBTWMsYUFBcUMsQ0FBQztZQUM1Q0osSUFBSWQsT0FBTyxDQUFDLENBQUNpQixNQUFNRTtnQkFDakIsTUFBTUMsTUFBTWIsYUFBYSxDQUFDWSxJQUFJO2dCQUM5QixJQUFJQyxLQUFLO29CQUNQRixVQUFVLENBQUNFLElBQUksR0FBR0gsS0FBS3RCLElBQUk7Z0JBQzdCO1lBQ0Y7WUFDQUksUUFBUXNCLElBQUksQ0FBQztnQkFDWEMsU0FBU3hCLE9BQU93QixPQUFPO2dCQUN2Qko7Z0JBQ0FLLFVBQVVUO2dCQUNWTixRQUFRSDtnQkFDUm1CLFFBQVE7b0JBQUV0QjtvQkFBWVksS0FBS0MsWUFBWTtnQkFBRTtZQUMzQztRQUNGO0lBQ0Y7SUFFQSxPQUFPaEI7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3JlcG9ydC1hc3Npc3RhbnQvLi9saWIvY2FzZXMudHM/MGU0MyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IERvY3hUYWJsZSB9IGZyb20gJ0AvbGliL2RvY3gnO1xuaW1wb3J0IHsgUGFyc2VkQ2FzZVJvdyB9IGZyb20gJ0AvbGliL3R5cGVzJztcblxuZnVuY3Rpb24gbm9ybWFsaXplSGVhZGVyKHRleHQ6IHN0cmluZykge1xuICByZXR1cm4gdGV4dC5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0cmFjdENhc2VSb3dzKHRhYmxlczogRG9jeFRhYmxlW10sIGNvbmZpZzogeyBzZWN0aW9uOiBzdHJpbmc7IGhlYWRlck1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSB7XG4gIGNvbnN0IHJlc3VsdHM6IFBhcnNlZENhc2VSb3dbXSA9IFtdO1xuXG4gIHRhYmxlcy5mb3JFYWNoKCh0YWJsZSwgdGFibGVJbmRleCkgPT4ge1xuICAgIGlmICh0YWJsZS5yb3dzLmxlbmd0aCA8IDIpIHJldHVybjtcbiAgICBjb25zdCBoZWFkZXJSb3cgPSB0YWJsZS5yb3dzWzBdLm1hcChub3JtYWxpemVIZWFkZXIpO1xuICAgIGNvbnN0IG1hcHBlZEhlYWRlcnMgPSBoZWFkZXJSb3cubWFwKChoZWFkZXIpID0+IGNvbmZpZy5oZWFkZXJNYXBbaGVhZGVyXSB8fCBudWxsKTtcbiAgICBjb25zdCBtYXRjaGVkQ291bnQgPSBtYXBwZWRIZWFkZXJzLmZpbHRlcihCb29sZWFuKS5sZW5ndGg7XG4gICAgaWYgKG1hdGNoZWRDb3VudCA8IDIpIHJldHVybjtcblxuICAgIHRhYmxlLnJvd3Muc2xpY2UoMSkuZm9yRWFjaCgocm93LCByb3dPZmZzZXQpID0+IHtcbiAgICAgIGlmIChyb3cuZXZlcnkoKGNlbGwpID0+IGNlbGwudHJpbSgpLmxlbmd0aCA9PT0gMCkpIHJldHVybjtcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWQ6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICAgIHJvdy5mb3JFYWNoKChjZWxsLCBpZHgpID0+IHtcbiAgICAgICAgY29uc3Qga2V5ID0gbWFwcGVkSGVhZGVyc1tpZHhdO1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgbm9ybWFsaXplZFtrZXldID0gY2VsbC50cmltKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgc2VjdGlvbjogY29uZmlnLnNlY3Rpb24sXG4gICAgICAgIG5vcm1hbGl6ZWQsXG4gICAgICAgIHJhd0NlbGxzOiByb3csXG4gICAgICAgIGhlYWRlcjogaGVhZGVyUm93LFxuICAgICAgICBzb3VyY2U6IHsgdGFibGVJbmRleCwgcm93OiByb3dPZmZzZXQgKyAxIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gcmVzdWx0cztcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJub3JtYWxpemVIZWFkZXIiLCJ0ZXh0IiwicmVwbGFjZSIsInRyaW0iLCJleHRyYWN0Q2FzZVJvd3MiLCJ0YWJsZXMiLCJjb25maWciLCJyZXN1bHRzIiwiZm9yRWFjaCIsInRhYmxlIiwidGFibGVJbmRleCIsInJvd3MiLCJsZW5ndGgiLCJoZWFkZXJSb3ciLCJtYXAiLCJtYXBwZWRIZWFkZXJzIiwiaGVhZGVyIiwiaGVhZGVyTWFwIiwibWF0Y2hlZENvdW50IiwiZmlsdGVyIiwiQm9vbGVhbiIsInNsaWNlIiwicm93Iiwicm93T2Zmc2V0IiwiZXZlcnkiLCJjZWxsIiwibm9ybWFsaXplZCIsImlkeCIsImtleSIsInB1c2giLCJzZWN0aW9uIiwicmF3Q2VsbHMiLCJzb3VyY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/cases.ts\n");

/***/ }),

/***/ "(rsc)/./lib/config.ts":
/*!***********************!*\
  !*** ./lib/config.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCarryOverRules: () => (/* binding */ getCarryOverRules),\n/* harmony export */   getCaseFieldMap: () => (/* binding */ getCaseFieldMap),\n/* harmony export */   getCaseRules: () => (/* binding */ getCaseRules),\n/* harmony export */   getCrossChecks: () => (/* binding */ getCrossChecks),\n/* harmony export */   getMetricCellMap: () => (/* binding */ getMetricCellMap),\n/* harmony export */   getMetricDictionary: () => (/* binding */ getMetricDictionary),\n/* harmony export */   getMetricRules: () => (/* binding */ getMetricRules),\n/* harmony export */   getRequiredMetrics: () => (/* binding */ getRequiredMetrics),\n/* harmony export */   writeMetricCellMap: () => (/* binding */ writeMetricCellMap)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst root = process.cwd();\nasync function readJson(file) {\n    const content = await fs__WEBPACK_IMPORTED_MODULE_0__.promises.readFile(path__WEBPACK_IMPORTED_MODULE_1___default().join(root, file), \"utf8\");\n    const cleaned = content.replace(/^\\uFEFF/, \"\");\n    return JSON.parse(cleaned);\n}\nasync function getMetricCellMap() {\n    return readJson(\"config/metricCellMap.json\");\n}\nasync function getRequiredMetrics() {\n    return readJson(\"config/requiredMetrics.json\");\n}\nasync function getMetricDictionary() {\n    return readJson(\"config/metricDictionary.json\");\n}\nasync function getMetricRules() {\n    return readJson(\"config/metricRules.json\");\n}\nasync function getCrossChecks() {\n    return readJson(\"config/crossChecks.json\");\n}\nasync function getCaseFieldMap() {\n    return readJson(\"config/caseFieldMap.json\");\n}\nasync function getCaseRules() {\n    return readJson(\"config/caseRules.json\");\n}\nasync function getCarryOverRules() {\n    return readJson(\"config/carryOverRules.json\");\n}\nasync function writeMetricCellMap(data) {\n    const file = path__WEBPACK_IMPORTED_MODULE_1___default().join(root, \"config/metricCellMap.json\");\n    await fs__WEBPACK_IMPORTED_MODULE_0__.promises.writeFile(file, JSON.stringify(data, null, 2), \"utf8\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY29uZmlnLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBb0M7QUFDWjtBQUV4QixNQUFNRyxPQUFPQyxRQUFRQyxHQUFHO0FBRXhCLGVBQWVDLFNBQVlDLElBQVk7SUFDckMsTUFBTUMsVUFBVSxNQUFNUCx3Q0FBRUEsQ0FBQ1EsUUFBUSxDQUFDUCxnREFBUyxDQUFDQyxNQUFNSSxPQUFPO0lBQ3pELE1BQU1JLFVBQVVILFFBQVFJLE9BQU8sQ0FBQyxXQUFXO0lBQzNDLE9BQU9DLEtBQUtDLEtBQUssQ0FBQ0g7QUFDcEI7QUFFTyxlQUFlSTtJQUNwQixPQUFPVCxTQUEwRDtBQUNuRTtBQUVPLGVBQWVVO0lBQ3BCLE9BQU9WLFNBQW1CO0FBQzVCO0FBRU8sZUFBZVc7SUFDcEIsT0FBT1gsU0FBaUU7QUFDMUU7QUFFTyxlQUFlWTtJQUNwQixPQUFPWixTQUFpSztBQUMxSztBQUVPLGVBQWVhO0lBQ3BCLE9BQU9iLFNBQXlFO0FBQ2xGO0FBRU8sZUFBZWM7SUFDcEIsT0FBT2QsU0FBaUU7QUFDMUU7QUFFTyxlQUFlZTtJQUNwQixPQUFPZixTQUE2RjtBQUN0RztBQUVPLGVBQWVnQjtJQUNwQixPQUFPaEIsU0FBbUg7QUFDNUg7QUFFTyxlQUFlaUIsbUJBQW1CQyxJQUFxRDtJQUM1RixNQUFNakIsT0FBT0wsZ0RBQVMsQ0FBQ0MsTUFBTTtJQUM3QixNQUFNRix3Q0FBRUEsQ0FBQ3dCLFNBQVMsQ0FBQ2xCLE1BQU1NLEtBQUthLFNBQVMsQ0FBQ0YsTUFBTSxNQUFNLElBQUk7QUFDMUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZXBvcnQtYXNzaXN0YW50Ly4vbGliL2NvbmZpZy50cz8xMjg1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByb21pc2VzIGFzIGZzIH0gZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbmNvbnN0IHJvb3QgPSBwcm9jZXNzLmN3ZCgpO1xuXG5hc3luYyBmdW5jdGlvbiByZWFkSnNvbjxUPihmaWxlOiBzdHJpbmcpOiBQcm9taXNlPFQ+IHtcbiAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKHBhdGguam9pbihyb290LCBmaWxlKSwgJ3V0ZjgnKTtcbiAgY29uc3QgY2xlYW5lZCA9IGNvbnRlbnQucmVwbGFjZSgvXlxcdUZFRkYvLCAnJyk7XG4gIHJldHVybiBKU09OLnBhcnNlKGNsZWFuZWQpIGFzIFQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRNZXRyaWNDZWxsTWFwKCkge1xuICByZXR1cm4gcmVhZEpzb248UmVjb3JkPHN0cmluZywgeyBzaGVldDogc3RyaW5nOyBjZWxsOiBzdHJpbmcgfT4+KCdjb25maWcvbWV0cmljQ2VsbE1hcC5qc29uJyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRSZXF1aXJlZE1ldHJpY3MoKSB7XG4gIHJldHVybiByZWFkSnNvbjxzdHJpbmdbXT4oJ2NvbmZpZy9yZXF1aXJlZE1ldHJpY3MuanNvbicpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWV0cmljRGljdGlvbmFyeSgpIHtcbiAgcmV0dXJuIHJlYWRKc29uPFJlY29yZDxzdHJpbmcsIHsgcGF0dGVybnM6IEFycmF5PHsgcmVnZXg6IHN0cmluZyB9PiB9Pj4oJ2NvbmZpZy9tZXRyaWNEaWN0aW9uYXJ5Lmpzb24nKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE1ldHJpY1J1bGVzKCkge1xuICByZXR1cm4gcmVhZEpzb248eyBkZWZhdWx0czogeyBtaW46IG51bWJlcjsgbWF4OiBudW1iZXI7IGFsbG93TmVnYXRpdmU6IGJvb2xlYW4gfTsgb3ZlcnJpZGVzOiBSZWNvcmQ8c3RyaW5nLCB7IG1pbj86IG51bWJlcjsgbWF4PzogbnVtYmVyOyBhbGxvd05lZ2F0aXZlPzogYm9vbGVhbiB9PiB9PignY29uZmlnL21ldHJpY1J1bGVzLmpzb24nKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENyb3NzQ2hlY2tzKCkge1xuICByZXR1cm4gcmVhZEpzb248QXJyYXk8eyB0b3RhbDogc3RyaW5nOyBjb21wb25lbnRzOiBzdHJpbmdbXTsgcmVhc29uOiBzdHJpbmcgfT4+KCdjb25maWcvY3Jvc3NDaGVja3MuanNvbicpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2FzZUZpZWxkTWFwKCkge1xuICByZXR1cm4gcmVhZEpzb248eyBzZWN0aW9uOiBzdHJpbmc7IGhlYWRlck1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9PignY29uZmlnL2Nhc2VGaWVsZE1hcC5qc29uJyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXNlUnVsZXMoKSB7XG4gIHJldHVybiByZWFkSnNvbjx7IGNhc2VDb3VudE1ldHJpYzogc3RyaW5nOyBjYXNlSWRGaWVsZDogc3RyaW5nOyBkdXBsaWNhdGVQb2xpY3k6ICdmYWlsJyB8ICd3YXJuJyB9PignY29uZmlnL2Nhc2VSdWxlcy5qc29uJyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDYXJyeU92ZXJSdWxlcygpIHtcbiAgcmV0dXJuIHJlYWRKc29uPEFycmF5PHsgc291cmNlTWV0cmljOiBzdHJpbmc7IHRhcmdldE1ldHJpYzogc3RyaW5nOyBvcGVyYXRpb246ICdhZGQnIHwgJ3JlcGxhY2UnOyBkZXNjcmlwdGlvbjogc3RyaW5nIH0+PignY29uZmlnL2NhcnJ5T3ZlclJ1bGVzLmpzb24nKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdyaXRlTWV0cmljQ2VsbE1hcChkYXRhOiBSZWNvcmQ8c3RyaW5nLCB7IHNoZWV0OiBzdHJpbmc7IGNlbGw6IHN0cmluZyB9Pikge1xuICBjb25zdCBmaWxlID0gcGF0aC5qb2luKHJvb3QsICdjb25maWcvbWV0cmljQ2VsbE1hcC5qc29uJyk7XG4gIGF3YWl0IGZzLndyaXRlRmlsZShmaWxlLCBKU09OLnN0cmluZ2lmeShkYXRhLCBudWxsLCAyKSwgJ3V0ZjgnKTtcbn1cblxyXG4iXSwibmFtZXMiOlsicHJvbWlzZXMiLCJmcyIsInBhdGgiLCJyb290IiwicHJvY2VzcyIsImN3ZCIsInJlYWRKc29uIiwiZmlsZSIsImNvbnRlbnQiLCJyZWFkRmlsZSIsImpvaW4iLCJjbGVhbmVkIiwicmVwbGFjZSIsIkpTT04iLCJwYXJzZSIsImdldE1ldHJpY0NlbGxNYXAiLCJnZXRSZXF1aXJlZE1ldHJpY3MiLCJnZXRNZXRyaWNEaWN0aW9uYXJ5IiwiZ2V0TWV0cmljUnVsZXMiLCJnZXRDcm9zc0NoZWNrcyIsImdldENhc2VGaWVsZE1hcCIsImdldENhc2VSdWxlcyIsImdldENhcnJ5T3ZlclJ1bGVzIiwid3JpdGVNZXRyaWNDZWxsTWFwIiwiZGF0YSIsIndyaXRlRmlsZSIsInN0cmluZ2lmeSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./lib/docx.ts":
/*!*********************!*\
  !*** ./lib/docx.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parseDocx: () => (/* binding */ parseDocx)\n/* harmony export */ });\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jszip */ \"(rsc)/./node_modules/jszip/lib/index.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jszip__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fast_xml_parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fast-xml-parser */ \"(rsc)/./node_modules/fast-xml-parser/src/fxp.js\");\n/* harmony import */ var fast_xml_parser__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fast_xml_parser__WEBPACK_IMPORTED_MODULE_1__);\n\n\nfunction asArray(value) {\n    if (!value) return [];\n    return Array.isArray(value) ? value : [\n        value\n    ];\n}\nfunction extractTextFromRuns(runs) {\n    const runArray = asArray(runs);\n    const texts = [];\n    for (const run of runArray){\n        const t = run?.[\"w:t\"];\n        if (typeof t === \"string\") {\n            texts.push(t);\n        } else if (t && typeof t === \"object\" && typeof t[\"#text\"] === \"string\") {\n            texts.push(t[\"#text\"]);\n        }\n    }\n    return texts.join(\" \").replace(/\\s+/g, \" \").trim();\n}\nfunction extractTextFromParagraph(p) {\n    const runs = p?.[\"w:r\"];\n    return extractTextFromRuns(runs);\n}\nfunction extractTextFromCell(cell) {\n    const paragraphs = asArray(cell?.[\"w:p\"]);\n    const parts = paragraphs.map(extractTextFromParagraph).filter(Boolean);\n    return parts.join(\" | \").replace(/\\s+/g, \" \").trim();\n}\nasync function parseDocx(buffer) {\n    const zip = await jszip__WEBPACK_IMPORTED_MODULE_0___default().loadAsync(buffer);\n    const documentXml = await zip.file(\"word/document.xml\")?.async(\"string\");\n    if (!documentXml) {\n        throw new Error(\"DOCX missing word/document.xml\");\n    }\n    const parser = new fast_xml_parser__WEBPACK_IMPORTED_MODULE_1__.XMLParser({\n        ignoreAttributes: false,\n        attributeNamePrefix: \"\"\n    });\n    const doc = parser.parse(documentXml);\n    const body = doc?.[\"w:document\"]?.[\"w:body\"];\n    if (!body) {\n        throw new Error(\"DOCX missing w:body\");\n    }\n    const elements = [\n        ...asArray(body[\"w:p\"]).map((p)=>({\n                type: \"p\",\n                node: p\n            })),\n        ...asArray(body[\"w:tbl\"]).map((t)=>({\n                type: \"tbl\",\n                node: t\n            }))\n    ];\n    const paragraphs = [];\n    const tables = [];\n    let paragraphIndex = 0;\n    for (const element of elements){\n        if (element.type === \"p\") {\n            const text = extractTextFromParagraph(element.node);\n            if (text) {\n                paragraphs.push({\n                    text,\n                    index: paragraphIndex++\n                });\n            }\n        } else if (element.type === \"tbl\") {\n            const rows = [];\n            const tr = asArray(element.node?.[\"w:tr\"]);\n            for (const row of tr){\n                const cells = asArray(row?.[\"w:tc\"]);\n                const rowText = cells.map(extractTextFromCell);\n                if (rowText.some((value)=>value.length > 0)) {\n                    rows.push(rowText);\n                }\n            }\n            if (rows.length > 0) {\n                tables.push({\n                    rows\n                });\n            }\n        }\n    }\n    return {\n        paragraphs,\n        tables\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZG9jeC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUEwQjtBQUNrQjtBQUs1QyxTQUFTRSxRQUFXQyxLQUEwQjtJQUM1QyxJQUFJLENBQUNBLE9BQU8sT0FBTyxFQUFFO0lBQ3JCLE9BQU9DLE1BQU1DLE9BQU8sQ0FBQ0YsU0FBU0EsUUFBUTtRQUFDQTtLQUFNO0FBQy9DO0FBRUEsU0FBU0csb0JBQW9CQyxJQUFTO0lBQ3BDLE1BQU1DLFdBQVdOLFFBQVFLO0lBQ3pCLE1BQU1FLFFBQWtCLEVBQUU7SUFDMUIsS0FBSyxNQUFNQyxPQUFPRixTQUFVO1FBQzFCLE1BQU1HLElBQUlELEtBQUssQ0FBQyxNQUFNO1FBQ3RCLElBQUksT0FBT0MsTUFBTSxVQUFVO1lBQ3pCRixNQUFNRyxJQUFJLENBQUNEO1FBQ2IsT0FBTyxJQUFJQSxLQUFLLE9BQU9BLE1BQU0sWUFBWSxPQUFPQSxDQUFDLENBQUMsUUFBUSxLQUFLLFVBQVU7WUFDdkVGLE1BQU1HLElBQUksQ0FBQ0QsQ0FBQyxDQUFDLFFBQVE7UUFDdkI7SUFDRjtJQUNBLE9BQU9GLE1BQU1JLElBQUksQ0FBQyxLQUFLQyxPQUFPLENBQUMsUUFBUSxLQUFLQyxJQUFJO0FBQ2xEO0FBRUEsU0FBU0MseUJBQXlCQyxDQUFNO0lBQ3RDLE1BQU1WLE9BQU9VLEdBQUcsQ0FBQyxNQUFNO0lBQ3ZCLE9BQU9YLG9CQUFvQkM7QUFDN0I7QUFFQSxTQUFTVyxvQkFBb0JDLElBQVM7SUFDcEMsTUFBTUMsYUFBYWxCLFFBQVFpQixNQUFNLENBQUMsTUFBTTtJQUN4QyxNQUFNRSxRQUFRRCxXQUFXRSxHQUFHLENBQUNOLDBCQUEwQk8sTUFBTSxDQUFDQztJQUM5RCxPQUFPSCxNQUFNUixJQUFJLENBQUMsT0FBT0MsT0FBTyxDQUFDLFFBQVEsS0FBS0MsSUFBSTtBQUNwRDtBQUVPLGVBQWVVLFVBQVVDLE1BQW1CO0lBQ2pELE1BQU1DLE1BQU0sTUFBTTNCLHNEQUFlLENBQUMwQjtJQUNsQyxNQUFNRyxjQUFjLE1BQU1GLElBQUlHLElBQUksQ0FBQyxzQkFBc0JDLE1BQU07SUFDL0QsSUFBSSxDQUFDRixhQUFhO1FBQ2hCLE1BQU0sSUFBSUcsTUFBTTtJQUNsQjtJQUVBLE1BQU1DLFNBQVMsSUFBSWhDLHNEQUFTQSxDQUFDO1FBQUVpQyxrQkFBa0I7UUFBT0MscUJBQXFCO0lBQUc7SUFDaEYsTUFBTUMsTUFBTUgsT0FBT0ksS0FBSyxDQUFDUjtJQUN6QixNQUFNUyxPQUFPRixLQUFLLENBQUMsYUFBYSxFQUFFLENBQUMsU0FBUztJQUM1QyxJQUFJLENBQUNFLE1BQU07UUFDVCxNQUFNLElBQUlOLE1BQU07SUFDbEI7SUFFQSxNQUFNTyxXQUFXO1dBQUlyQyxRQUFRb0MsSUFBSSxDQUFDLE1BQU0sRUFBRWhCLEdBQUcsQ0FBQyxDQUFDTCxJQUFZO2dCQUFFdUIsTUFBTTtnQkFBS0MsTUFBTXhCO1lBQUU7V0FBUWYsUUFBUW9DLElBQUksQ0FBQyxRQUFRLEVBQUVoQixHQUFHLENBQUMsQ0FBQ1gsSUFBWTtnQkFBRTZCLE1BQU07Z0JBQU9DLE1BQU05QjtZQUFFO0tBQUk7SUFFM0osTUFBTVMsYUFBOEIsRUFBRTtJQUN0QyxNQUFNc0IsU0FBc0IsRUFBRTtJQUU5QixJQUFJQyxpQkFBaUI7SUFFckIsS0FBSyxNQUFNQyxXQUFXTCxTQUFVO1FBQzlCLElBQUlLLFFBQVFKLElBQUksS0FBSyxLQUFLO1lBQ3hCLE1BQU1LLE9BQU83Qix5QkFBeUI0QixRQUFRSCxJQUFJO1lBQ2xELElBQUlJLE1BQU07Z0JBQ1J6QixXQUFXUixJQUFJLENBQUM7b0JBQUVpQztvQkFBTUMsT0FBT0g7Z0JBQWlCO1lBQ2xEO1FBQ0YsT0FBTyxJQUFJQyxRQUFRSixJQUFJLEtBQUssT0FBTztZQUNqQyxNQUFNTyxPQUFtQixFQUFFO1lBQzNCLE1BQU1DLEtBQUs5QyxRQUFRMEMsUUFBUUgsSUFBSSxFQUFFLENBQUMsT0FBTztZQUN6QyxLQUFLLE1BQU1RLE9BQU9ELEdBQUk7Z0JBQ3BCLE1BQU1FLFFBQVFoRCxRQUFRK0MsS0FBSyxDQUFDLE9BQU87Z0JBQ25DLE1BQU1FLFVBQVVELE1BQU01QixHQUFHLENBQUNKO2dCQUMxQixJQUFJaUMsUUFBUUMsSUFBSSxDQUFDLENBQUNqRCxRQUFVQSxNQUFNa0QsTUFBTSxHQUFHLElBQUk7b0JBQzdDTixLQUFLbkMsSUFBSSxDQUFDdUM7Z0JBQ1o7WUFDRjtZQUNBLElBQUlKLEtBQUtNLE1BQU0sR0FBRyxHQUFHO2dCQUNuQlgsT0FBTzlCLElBQUksQ0FBQztvQkFBRW1DO2dCQUFLO1lBQ3JCO1FBQ0Y7SUFDRjtJQUVBLE9BQU87UUFBRTNCO1FBQVlzQjtJQUFPO0FBQzlCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVwb3J0LWFzc2lzdGFudC8uL2xpYi9kb2N4LnRzP2Y2MDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEpTWmlwIGZyb20gJ2pzemlwJztcbmltcG9ydCB7IFhNTFBhcnNlciB9IGZyb20gJ2Zhc3QteG1sLXBhcnNlcic7XG5cbmV4cG9ydCB0eXBlIERvY3hQYXJhZ3JhcGggPSB7IHRleHQ6IHN0cmluZzsgaW5kZXg6IG51bWJlciB9O1xuZXhwb3J0IHR5cGUgRG9jeFRhYmxlID0geyByb3dzOiBzdHJpbmdbXVtdIH07XG5cbmZ1bmN0aW9uIGFzQXJyYXk8VD4odmFsdWU6IFQgfCBUW10gfCB1bmRlZmluZWQpOiBUW10ge1xuICBpZiAoIXZhbHVlKSByZXR1cm4gW107XG4gIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTtcbn1cblxuZnVuY3Rpb24gZXh0cmFjdFRleHRGcm9tUnVucyhydW5zOiBhbnkpOiBzdHJpbmcge1xuICBjb25zdCBydW5BcnJheSA9IGFzQXJyYXkocnVucyk7XG4gIGNvbnN0IHRleHRzOiBzdHJpbmdbXSA9IFtdO1xuICBmb3IgKGNvbnN0IHJ1biBvZiBydW5BcnJheSkge1xuICAgIGNvbnN0IHQgPSBydW4/Llsndzp0J107XG4gICAgaWYgKHR5cGVvZiB0ID09PSAnc3RyaW5nJykge1xuICAgICAgdGV4dHMucHVzaCh0KTtcbiAgICB9IGVsc2UgaWYgKHQgJiYgdHlwZW9mIHQgPT09ICdvYmplY3QnICYmIHR5cGVvZiB0WycjdGV4dCddID09PSAnc3RyaW5nJykge1xuICAgICAgdGV4dHMucHVzaCh0WycjdGV4dCddKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRleHRzLmpvaW4oJyAnKS5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xufVxuXG5mdW5jdGlvbiBleHRyYWN0VGV4dEZyb21QYXJhZ3JhcGgocDogYW55KTogc3RyaW5nIHtcbiAgY29uc3QgcnVucyA9IHA/LlsndzpyJ107XG4gIHJldHVybiBleHRyYWN0VGV4dEZyb21SdW5zKHJ1bnMpO1xufVxuXG5mdW5jdGlvbiBleHRyYWN0VGV4dEZyb21DZWxsKGNlbGw6IGFueSk6IHN0cmluZyB7XG4gIGNvbnN0IHBhcmFncmFwaHMgPSBhc0FycmF5KGNlbGw/LlsndzpwJ10pO1xuICBjb25zdCBwYXJ0cyA9IHBhcmFncmFwaHMubWFwKGV4dHJhY3RUZXh0RnJvbVBhcmFncmFwaCkuZmlsdGVyKEJvb2xlYW4pO1xuICByZXR1cm4gcGFydHMuam9pbignIHwgJykucmVwbGFjZSgvXFxzKy9nLCAnICcpLnRyaW0oKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHBhcnNlRG9jeChidWZmZXI6IEFycmF5QnVmZmVyKSB7XG4gIGNvbnN0IHppcCA9IGF3YWl0IEpTWmlwLmxvYWRBc3luYyhidWZmZXIpO1xuICBjb25zdCBkb2N1bWVudFhtbCA9IGF3YWl0IHppcC5maWxlKCd3b3JkL2RvY3VtZW50LnhtbCcpPy5hc3luYygnc3RyaW5nJyk7XG4gIGlmICghZG9jdW1lbnRYbWwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0RPQ1ggbWlzc2luZyB3b3JkL2RvY3VtZW50LnhtbCcpO1xuICB9XG5cbiAgY29uc3QgcGFyc2VyID0gbmV3IFhNTFBhcnNlcih7IGlnbm9yZUF0dHJpYnV0ZXM6IGZhbHNlLCBhdHRyaWJ1dGVOYW1lUHJlZml4OiAnJyB9KTtcbiAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlKGRvY3VtZW50WG1sKTtcbiAgY29uc3QgYm9keSA9IGRvYz8uWyd3OmRvY3VtZW50J10/Llsndzpib2R5J107XG4gIGlmICghYm9keSkge1xuICAgIHRocm93IG5ldyBFcnJvcignRE9DWCBtaXNzaW5nIHc6Ym9keScpO1xuICB9XG5cbiAgY29uc3QgZWxlbWVudHMgPSBbLi4uYXNBcnJheShib2R5Wyd3OnAnXSkubWFwKChwOiBhbnkpID0+ICh7IHR5cGU6ICdwJywgbm9kZTogcCB9KSksIC4uLmFzQXJyYXkoYm9keVsndzp0YmwnXSkubWFwKCh0OiBhbnkpID0+ICh7IHR5cGU6ICd0YmwnLCBub2RlOiB0IH0pKV07XG5cbiAgY29uc3QgcGFyYWdyYXBoczogRG9jeFBhcmFncmFwaFtdID0gW107XG4gIGNvbnN0IHRhYmxlczogRG9jeFRhYmxlW10gPSBbXTtcblxuICBsZXQgcGFyYWdyYXBoSW5kZXggPSAwO1xuXG4gIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50cykge1xuICAgIGlmIChlbGVtZW50LnR5cGUgPT09ICdwJykge1xuICAgICAgY29uc3QgdGV4dCA9IGV4dHJhY3RUZXh0RnJvbVBhcmFncmFwaChlbGVtZW50Lm5vZGUpO1xuICAgICAgaWYgKHRleHQpIHtcbiAgICAgICAgcGFyYWdyYXBocy5wdXNoKHsgdGV4dCwgaW5kZXg6IHBhcmFncmFwaEluZGV4KysgfSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChlbGVtZW50LnR5cGUgPT09ICd0YmwnKSB7XG4gICAgICBjb25zdCByb3dzOiBzdHJpbmdbXVtdID0gW107XG4gICAgICBjb25zdCB0ciA9IGFzQXJyYXkoZWxlbWVudC5ub2RlPy5bJ3c6dHInXSk7XG4gICAgICBmb3IgKGNvbnN0IHJvdyBvZiB0cikge1xuICAgICAgICBjb25zdCBjZWxscyA9IGFzQXJyYXkocm93Py5bJ3c6dGMnXSk7XG4gICAgICAgIGNvbnN0IHJvd1RleHQgPSBjZWxscy5tYXAoZXh0cmFjdFRleHRGcm9tQ2VsbCk7XG4gICAgICAgIGlmIChyb3dUZXh0LnNvbWUoKHZhbHVlKSA9PiB2YWx1ZS5sZW5ndGggPiAwKSkge1xuICAgICAgICAgIHJvd3MucHVzaChyb3dUZXh0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHJvd3MubGVuZ3RoID4gMCkge1xuICAgICAgICB0YWJsZXMucHVzaCh7IHJvd3MgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgcGFyYWdyYXBocywgdGFibGVzIH07XG59XHJcblxyXG4iXSwibmFtZXMiOlsiSlNaaXAiLCJYTUxQYXJzZXIiLCJhc0FycmF5IiwidmFsdWUiLCJBcnJheSIsImlzQXJyYXkiLCJleHRyYWN0VGV4dEZyb21SdW5zIiwicnVucyIsInJ1bkFycmF5IiwidGV4dHMiLCJydW4iLCJ0IiwicHVzaCIsImpvaW4iLCJyZXBsYWNlIiwidHJpbSIsImV4dHJhY3RUZXh0RnJvbVBhcmFncmFwaCIsInAiLCJleHRyYWN0VGV4dEZyb21DZWxsIiwiY2VsbCIsInBhcmFncmFwaHMiLCJwYXJ0cyIsIm1hcCIsImZpbHRlciIsIkJvb2xlYW4iLCJwYXJzZURvY3giLCJidWZmZXIiLCJ6aXAiLCJsb2FkQXN5bmMiLCJkb2N1bWVudFhtbCIsImZpbGUiLCJhc3luYyIsIkVycm9yIiwicGFyc2VyIiwiaWdub3JlQXR0cmlidXRlcyIsImF0dHJpYnV0ZU5hbWVQcmVmaXgiLCJkb2MiLCJwYXJzZSIsImJvZHkiLCJlbGVtZW50cyIsInR5cGUiLCJub2RlIiwidGFibGVzIiwicGFyYWdyYXBoSW5kZXgiLCJlbGVtZW50IiwidGV4dCIsImluZGV4Iiwicm93cyIsInRyIiwicm93IiwiY2VsbHMiLCJyb3dUZXh0Iiwic29tZSIsImxlbmd0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/docx.ts\n");

/***/ }),

/***/ "(rsc)/./lib/excel.ts":
/*!**********************!*\
  !*** ./lib/excel.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyCarryOverRules: () => (/* binding */ applyCarryOverRules),\n/* harmony export */   detectExcelRisks: () => (/* binding */ detectExcelRisks),\n/* harmony export */   updateWorkbook: () => (/* binding */ updateWorkbook)\n/* harmony export */ });\n/* harmony import */ var exceljs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! exceljs */ \"(rsc)/./node_modules/exceljs/excel.js\");\n/* harmony import */ var exceljs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(exceljs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jszip */ \"(rsc)/./node_modules/jszip/lib/index.js\");\n/* harmony import */ var jszip__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jszip__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_validate__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/validate */ \"(rsc)/./lib/validate.ts\");\n\n\n\nasync function detectExcelRisks(buffer, filename) {\n    const errors = [];\n    if (filename && filename.toLowerCase().endsWith(\".xlsm\")) {\n        errors.push(\"Excel workbook is .xlsm with macros. ExcelJS cannot safely preserve macros.\");\n    }\n    const zip = await jszip__WEBPACK_IMPORTED_MODULE_1___default().loadAsync(buffer);\n    const entries = Object.keys(zip.files);\n    if (entries.some((name)=>name.toLowerCase().includes(\"vbaProject.bin\".toLowerCase()))) {\n        errors.push(\"Excel workbook contains macros (vbaProject.bin).\");\n    }\n    if (entries.some((name)=>name.toLowerCase().includes(\"pivotcache\") || name.toLowerCase().includes(\"pivottable\"))) {\n        errors.push(\"Excel workbook contains pivot caches/tables that ExcelJS may break.\");\n    }\n    return errors;\n}\nfunction ensureSheet(workbook, name, headers) {\n    let sheet = workbook.getWorksheet(name);\n    if (!sheet) {\n        sheet = workbook.addWorksheet(name);\n        sheet.addRow(headers);\n    }\n    if (sheet.rowCount === 0) {\n        sheet.addRow(headers);\n    }\n    return sheet;\n}\nfunction applyCarryOverRules(metrics, rules) {\n    const result = new Map(metrics.map((m)=>[\n            m.name,\n            m.value\n        ]));\n    const applied = [];\n    rules.forEach((rule)=>{\n        const source = result.get(rule.sourceMetric);\n        const target = result.get(rule.targetMetric);\n        if (source === undefined || target === undefined) return;\n        const previous = target;\n        const next = rule.operation === \"add\" ? target + source : source;\n        result.set(rule.targetMetric, next);\n        applied.push({\n            rule: rule.description,\n            targetMetric: rule.targetMetric,\n            previous,\n            next\n        });\n    });\n    return {\n        effectiveMetrics: result,\n        applied\n    };\n}\nasync function updateWorkbook(params) {\n    const { buffer, metrics, cases, mapping, month, wordHash, excelHash, carryOverRules } = params;\n    const workbook = new (exceljs__WEBPACK_IMPORTED_MODULE_0___default().Workbook)();\n    await workbook.xlsx.load(Buffer.from(buffer));\n    const { effectiveMetrics, applied } = applyCarryOverRules(metrics, carryOverRules);\n    const metricMap = new Map(metrics.map((m)=>[\n            m.name,\n            m\n        ]));\n    const auditSheet = ensureSheet(workbook, \"Audit\", [\n        \"metric_name\",\n        \"prev_value\",\n        \"new_value\",\n        \"delta\",\n        \"source_snippet\",\n        \"source_location\",\n        \"cell_written\"\n    ]);\n    mapping && Object.entries(mapping).forEach(([metricName, location])=>{\n        const metric = metricMap.get(metricName);\n        if (!metric) return;\n        const sheet = workbook.getWorksheet(location.sheet) || workbook.addWorksheet(location.sheet);\n        const cell = sheet.getCell(location.cell);\n        const prevValue = typeof cell.value === \"number\" ? cell.value : null;\n        const newValue = effectiveMetrics.get(metricName) ?? metric.value;\n        cell.value = newValue;\n        const delta = typeof prevValue === \"number\" ? newValue - prevValue : null;\n        const summary = (0,_lib_validate__WEBPACK_IMPORTED_MODULE_2__.summarizeSource)(metric);\n        auditSheet.addRow([\n            metricName,\n            prevValue,\n            newValue,\n            delta,\n            summary.snippet,\n            summary.location,\n            `${location.sheet}!${location.cell}`\n        ]);\n    });\n    if (applied.length > 0) {\n        applied.forEach((item)=>{\n            auditSheet.addRow([\n                `${item.targetMetric} (carry-over)`,\n                item.previous,\n                item.next,\n                item.next - item.previous,\n                item.rule,\n                \"Carry-over rule\",\n                \"n/a\"\n            ]);\n        });\n    }\n    const summarySheet = ensureSheet(workbook, \"SummaryMetrics\", [\n        \"month\",\n        \"metric_name\",\n        \"value\",\n        \"source_info_json\"\n    ]);\n    metrics.forEach((metric)=>{\n        summarySheet.addRow([\n            month,\n            metric.name,\n            metric.value,\n            JSON.stringify(metric.source)\n        ]);\n    });\n    const caseSheet = ensureSheet(workbook, \"CaseFacts\", [\n        \"month\",\n        \"section\",\n        \"normalized_json\",\n        \"source_info_json\"\n    ]);\n    cases.forEach((row)=>{\n        caseSheet.addRow([\n            month,\n            row.section,\n            JSON.stringify(row.normalized),\n            JSON.stringify(row.source)\n        ]);\n    });\n    const logSheet = ensureSheet(workbook, \"ImportsLog\", [\n        \"timestamp\",\n        \"month\",\n        \"word_hash\",\n        \"excel_hash\",\n        \"status\"\n    ]);\n    logSheet.addRow([\n        new Date().toISOString(),\n        month,\n        wordHash,\n        excelHash,\n        \"generated\"\n    ]);\n    const output = await workbook.xlsx.writeBuffer();\n    return output;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSTtnQkFDVDtnQkFDQTthQUNEO1FBQ0g7SUFDRjtJQUVBLE1BQU13QyxlQUFlMUQsWUFBWUMsVUFBVSxrQkFBa0I7UUFDM0Q7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUNEUSxRQUFRUSxPQUFPLENBQUMsQ0FBQytCO1FBQ2ZVLGFBQWFwRCxNQUFNLENBQUM7WUFDbEI2QjtZQUNBYSxPQUFPbEQsSUFBSTtZQUNYa0QsT0FBT2pDLEtBQUs7WUFDWjRDLEtBQUtDLFNBQVMsQ0FBQ1osT0FBTzdCLE1BQU07U0FDN0I7SUFDSDtJQUVBLE1BQU0wQyxZQUFZN0QsWUFBWUMsVUFBVSxhQUFhO1FBQ25EO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFDRGdDLE1BQU1oQixPQUFPLENBQUMsQ0FBQzZDO1FBQ2JELFVBQVV2RCxNQUFNLENBQUM7WUFDZjZCO1lBQ0EyQixJQUFJQyxPQUFPO1lBQ1hKLEtBQUtDLFNBQVMsQ0FBQ0UsSUFBSUUsVUFBVTtZQUM3QkwsS0FBS0MsU0FBUyxDQUFDRSxJQUFJM0MsTUFBTTtTQUMxQjtJQUNIO0lBRUEsTUFBTThDLFdBQVdqRSxZQUFZQyxVQUFVLGNBQWM7UUFDbkQ7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBQ0RnRSxTQUFTM0QsTUFBTSxDQUFDO1FBQUMsSUFBSTRELE9BQU9DLFdBQVc7UUFBSWhDO1FBQU9DO1FBQVVDO1FBQVc7S0FBWTtJQUVuRixNQUFNK0IsU0FBUyxNQUFNbkUsU0FBU3VDLElBQUksQ0FBQzZCLFdBQVc7SUFDOUMsT0FBT0Q7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3JlcG9ydC1hc3Npc3RhbnQvLi9saWIvZXhjZWwudHM/OTk2OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRXhjZWxKUyBmcm9tICdleGNlbGpzJztcbmltcG9ydCBKU1ppcCBmcm9tICdqc3ppcCc7XG5pbXBvcnQgeyBQYXJzZWRDYXNlUm93LCBQYXJzZWRNZXRyaWMgfSBmcm9tICdAL2xpYi90eXBlcyc7XG5pbXBvcnQgeyBzdW1tYXJpemVTb3VyY2UgfSBmcm9tICdAL2xpYi92YWxpZGF0ZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZXRlY3RFeGNlbFJpc2tzKGJ1ZmZlcjogQXJyYXlCdWZmZXIsIGZpbGVuYW1lPzogc3RyaW5nKSB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgaWYgKGZpbGVuYW1lICYmIGZpbGVuYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy54bHNtJykpIHtcbiAgICBlcnJvcnMucHVzaCgnRXhjZWwgd29ya2Jvb2sgaXMgLnhsc20gd2l0aCBtYWNyb3MuIEV4Y2VsSlMgY2Fubm90IHNhZmVseSBwcmVzZXJ2ZSBtYWNyb3MuJyk7XG4gIH1cblxuICBjb25zdCB6aXAgPSBhd2FpdCBKU1ppcC5sb2FkQXN5bmMoYnVmZmVyKTtcbiAgY29uc3QgZW50cmllcyA9IE9iamVjdC5rZXlzKHppcC5maWxlcyk7XG4gIGlmIChlbnRyaWVzLnNvbWUoKG5hbWUpID0+IG5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygndmJhUHJvamVjdC5iaW4nLnRvTG93ZXJDYXNlKCkpKSkge1xuICAgIGVycm9ycy5wdXNoKCdFeGNlbCB3b3JrYm9vayBjb250YWlucyBtYWNyb3MgKHZiYVByb2plY3QuYmluKS4nKTtcbiAgfVxuICBpZiAoZW50cmllcy5zb21lKChuYW1lKSA9PiBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Bpdm90Y2FjaGUnKSB8fCBuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3Bpdm90dGFibGUnKSkpIHtcbiAgICBlcnJvcnMucHVzaCgnRXhjZWwgd29ya2Jvb2sgY29udGFpbnMgcGl2b3QgY2FjaGVzL3RhYmxlcyB0aGF0IEV4Y2VsSlMgbWF5IGJyZWFrLicpO1xuICB9XG5cbiAgcmV0dXJuIGVycm9ycztcbn1cblxuZnVuY3Rpb24gZW5zdXJlU2hlZXQod29ya2Jvb2s6IEV4Y2VsSlMuV29ya2Jvb2ssIG5hbWU6IHN0cmluZywgaGVhZGVyczogc3RyaW5nW10pIHtcbiAgbGV0IHNoZWV0ID0gd29ya2Jvb2suZ2V0V29ya3NoZWV0KG5hbWUpO1xuICBpZiAoIXNoZWV0KSB7XG4gICAgc2hlZXQgPSB3b3JrYm9vay5hZGRXb3Jrc2hlZXQobmFtZSk7XG4gICAgc2hlZXQuYWRkUm93KGhlYWRlcnMpO1xuICB9XG4gIGlmIChzaGVldC5yb3dDb3VudCA9PT0gMCkge1xuICAgIHNoZWV0LmFkZFJvdyhoZWFkZXJzKTtcbiAgfVxuICByZXR1cm4gc2hlZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBseUNhcnJ5T3ZlclJ1bGVzKFxuICBtZXRyaWNzOiBQYXJzZWRNZXRyaWNbXSxcbiAgcnVsZXM6IEFycmF5PHsgc291cmNlTWV0cmljOiBzdHJpbmc7IHRhcmdldE1ldHJpYzogc3RyaW5nOyBvcGVyYXRpb246ICdhZGQnIHwgJ3JlcGxhY2UnOyBkZXNjcmlwdGlvbjogc3RyaW5nIH0+XG4pIHtcbiAgY29uc3QgcmVzdWx0ID0gbmV3IE1hcChtZXRyaWNzLm1hcCgobSkgPT4gW20ubmFtZSwgbS52YWx1ZV0pKTtcbiAgY29uc3QgYXBwbGllZDogQXJyYXk8eyBydWxlOiBzdHJpbmc7IHRhcmdldE1ldHJpYzogc3RyaW5nOyBwcmV2aW91czogbnVtYmVyOyBuZXh0OiBudW1iZXIgfT4gPSBbXTtcblxuICBydWxlcy5mb3JFYWNoKChydWxlKSA9PiB7XG4gICAgY29uc3Qgc291cmNlID0gcmVzdWx0LmdldChydWxlLnNvdXJjZU1ldHJpYyk7XG4gICAgY29uc3QgdGFyZ2V0ID0gcmVzdWx0LmdldChydWxlLnRhcmdldE1ldHJpYyk7XG4gICAgaWYgKHNvdXJjZSA9PT0gdW5kZWZpbmVkIHx8IHRhcmdldCA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG4gICAgY29uc3QgcHJldmlvdXMgPSB0YXJnZXQ7XG4gICAgY29uc3QgbmV4dCA9IHJ1bGUub3BlcmF0aW9uID09PSAnYWRkJyA/IHRhcmdldCArIHNvdXJjZSA6IHNvdXJjZTtcbiAgICByZXN1bHQuc2V0KHJ1bGUudGFyZ2V0TWV0cmljLCBuZXh0KTtcbiAgICBhcHBsaWVkLnB1c2goeyBydWxlOiBydWxlLmRlc2NyaXB0aW9uLCB0YXJnZXRNZXRyaWM6IHJ1bGUudGFyZ2V0TWV0cmljLCBwcmV2aW91cywgbmV4dCB9KTtcbiAgfSk7XG5cbiAgcmV0dXJuIHsgZWZmZWN0aXZlTWV0cmljczogcmVzdWx0LCBhcHBsaWVkIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVXb3JrYm9vayhwYXJhbXM6IHtcbiAgYnVmZmVyOiBBcnJheUJ1ZmZlcjtcbiAgbWV0cmljczogUGFyc2VkTWV0cmljW107XG4gIGNhc2VzOiBQYXJzZWRDYXNlUm93W107XG4gIG1hcHBpbmc6IFJlY29yZDxzdHJpbmcsIHsgc2hlZXQ6IHN0cmluZzsgY2VsbDogc3RyaW5nIH0+O1xuICBtb250aDogc3RyaW5nO1xuICB3b3JkSGFzaDogc3RyaW5nO1xuICBleGNlbEhhc2g6IHN0cmluZztcbiAgY2FycnlPdmVyUnVsZXM6IEFycmF5PHsgc291cmNlTWV0cmljOiBzdHJpbmc7IHRhcmdldE1ldHJpYzogc3RyaW5nOyBvcGVyYXRpb246ICdhZGQnIHwgJ3JlcGxhY2UnOyBkZXNjcmlwdGlvbjogc3RyaW5nIH0+O1xufSkge1xuICBjb25zdCB7IGJ1ZmZlciwgbWV0cmljcywgY2FzZXMsIG1hcHBpbmcsIG1vbnRoLCB3b3JkSGFzaCwgZXhjZWxIYXNoLCBjYXJyeU92ZXJSdWxlcyB9ID0gcGFyYW1zO1xuICBjb25zdCB3b3JrYm9vayA9IG5ldyBFeGNlbEpTLldvcmtib29rKCk7XG4gIGF3YWl0IHdvcmtib29rLnhsc3gubG9hZChCdWZmZXIuZnJvbShidWZmZXIpKTtcblxuICBjb25zdCB7IGVmZmVjdGl2ZU1ldHJpY3MsIGFwcGxpZWQgfSA9IGFwcGx5Q2FycnlPdmVyUnVsZXMobWV0cmljcywgY2FycnlPdmVyUnVsZXMpO1xuICBjb25zdCBtZXRyaWNNYXAgPSBuZXcgTWFwKG1ldHJpY3MubWFwKChtKSA9PiBbbS5uYW1lLCBtXSkpO1xuXG4gIGNvbnN0IGF1ZGl0U2hlZXQgPSBlbnN1cmVTaGVldCh3b3JrYm9vaywgJ0F1ZGl0JywgW1xuICAgICdtZXRyaWNfbmFtZScsXG4gICAgJ3ByZXZfdmFsdWUnLFxuICAgICduZXdfdmFsdWUnLFxuICAgICdkZWx0YScsXG4gICAgJ3NvdXJjZV9zbmlwcGV0JyxcbiAgICAnc291cmNlX2xvY2F0aW9uJyxcbiAgICAnY2VsbF93cml0dGVuJ1xuICBdKTtcblxuICBtYXBwaW5nICYmIE9iamVjdC5lbnRyaWVzKG1hcHBpbmcpLmZvckVhY2goKFttZXRyaWNOYW1lLCBsb2NhdGlvbl0pID0+IHtcbiAgICBjb25zdCBtZXRyaWMgPSBtZXRyaWNNYXAuZ2V0KG1ldHJpY05hbWUpO1xuICAgIGlmICghbWV0cmljKSByZXR1cm47XG4gICAgY29uc3Qgc2hlZXQgPSB3b3JrYm9vay5nZXRXb3Jrc2hlZXQobG9jYXRpb24uc2hlZXQpIHx8IHdvcmtib29rLmFkZFdvcmtzaGVldChsb2NhdGlvbi5zaGVldCk7XG4gICAgY29uc3QgY2VsbCA9IHNoZWV0LmdldENlbGwobG9jYXRpb24uY2VsbCk7XG4gICAgY29uc3QgcHJldlZhbHVlID0gdHlwZW9mIGNlbGwudmFsdWUgPT09ICdudW1iZXInID8gY2VsbC52YWx1ZSA6IG51bGw7XG4gICAgY29uc3QgbmV3VmFsdWUgPSBlZmZlY3RpdmVNZXRyaWNzLmdldChtZXRyaWNOYW1lKSA/PyBtZXRyaWMudmFsdWU7XG4gICAgY2VsbC52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgIGNvbnN0IGRlbHRhID0gdHlwZW9mIHByZXZWYWx1ZSA9PT0gJ251bWJlcicgPyBuZXdWYWx1ZSAtIHByZXZWYWx1ZSA6IG51bGw7XG4gICAgY29uc3Qgc3VtbWFyeSA9IHN1bW1hcml6ZVNvdXJjZShtZXRyaWMpO1xuICAgIGF1ZGl0U2hlZXQuYWRkUm93KFtcbiAgICAgIG1ldHJpY05hbWUsXG4gICAgICBwcmV2VmFsdWUsXG4gICAgICBuZXdWYWx1ZSxcbiAgICAgIGRlbHRhLFxuICAgICAgc3VtbWFyeS5zbmlwcGV0LFxuICAgICAgc3VtbWFyeS5sb2NhdGlvbixcbiAgICAgIGAke2xvY2F0aW9uLnNoZWV0fSEke2xvY2F0aW9uLmNlbGx9YFxuICAgIF0pO1xuICB9KTtcblxuICBpZiAoYXBwbGllZC5sZW5ndGggPiAwKSB7XG4gICAgYXBwbGllZC5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICBhdWRpdFNoZWV0LmFkZFJvdyhbXG4gICAgICAgIGAke2l0ZW0udGFyZ2V0TWV0cmljfSAoY2Fycnktb3ZlcilgLFxuICAgICAgICBpdGVtLnByZXZpb3VzLFxuICAgICAgICBpdGVtLm5leHQsXG4gICAgICAgIGl0ZW0ubmV4dCAtIGl0ZW0ucHJldmlvdXMsXG4gICAgICAgIGl0ZW0ucnVsZSxcbiAgICAgICAgJ0NhcnJ5LW92ZXIgcnVsZScsXG4gICAgICAgICduL2EnXG4gICAgICBdKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHN1bW1hcnlTaGVldCA9IGVuc3VyZVNoZWV0KHdvcmtib29rLCAnU3VtbWFyeU1ldHJpY3MnLCBbXG4gICAgJ21vbnRoJyxcbiAgICAnbWV0cmljX25hbWUnLFxuICAgICd2YWx1ZScsXG4gICAgJ3NvdXJjZV9pbmZvX2pzb24nXG4gIF0pO1xuICBtZXRyaWNzLmZvckVhY2goKG1ldHJpYykgPT4ge1xuICAgIHN1bW1hcnlTaGVldC5hZGRSb3coW1xuICAgICAgbW9udGgsXG4gICAgICBtZXRyaWMubmFtZSxcbiAgICAgIG1ldHJpYy52YWx1ZSxcbiAgICAgIEpTT04uc3RyaW5naWZ5KG1ldHJpYy5zb3VyY2UpXG4gICAgXSk7XG4gIH0pO1xuXG4gIGNvbnN0IGNhc2VTaGVldCA9IGVuc3VyZVNoZWV0KHdvcmtib29rLCAnQ2FzZUZhY3RzJywgW1xuICAgICdtb250aCcsXG4gICAgJ3NlY3Rpb24nLFxuICAgICdub3JtYWxpemVkX2pzb24nLFxuICAgICdzb3VyY2VfaW5mb19qc29uJ1xuICBdKTtcbiAgY2FzZXMuZm9yRWFjaCgocm93KSA9PiB7XG4gICAgY2FzZVNoZWV0LmFkZFJvdyhbXG4gICAgICBtb250aCxcbiAgICAgIHJvdy5zZWN0aW9uLFxuICAgICAgSlNPTi5zdHJpbmdpZnkocm93Lm5vcm1hbGl6ZWQpLFxuICAgICAgSlNPTi5zdHJpbmdpZnkocm93LnNvdXJjZSlcbiAgICBdKTtcbiAgfSk7XG5cbiAgY29uc3QgbG9nU2hlZXQgPSBlbnN1cmVTaGVldCh3b3JrYm9vaywgJ0ltcG9ydHNMb2cnLCBbXG4gICAgJ3RpbWVzdGFtcCcsXG4gICAgJ21vbnRoJyxcbiAgICAnd29yZF9oYXNoJyxcbiAgICAnZXhjZWxfaGFzaCcsXG4gICAgJ3N0YXR1cydcbiAgXSk7XG4gIGxvZ1NoZWV0LmFkZFJvdyhbbmV3IERhdGUoKS50b0lTT1N0cmluZygpLCBtb250aCwgd29yZEhhc2gsIGV4Y2VsSGFzaCwgJ2dlbmVyYXRlZCddKTtcblxuICBjb25zdCBvdXRwdXQgPSBhd2FpdCB3b3JrYm9vay54bHN4LndyaXRlQnVmZmVyKCk7XG4gIHJldHVybiBvdXRwdXQ7XG59XHJcblxyXG4iXSwibmFtZXMiOlsiRXhjZWxKUyIsIkpTWmlwIiwic3VtbWFyaXplU291cmNlIiwiZGV0ZWN0RXhjZWxSaXNrcyIsImJ1ZmZlciIsImZpbGVuYW1lIiwiZXJyb3JzIiwidG9Mb3dlckNhc2UiLCJlbmRzV2l0aCIsInB1c2giLCJ6aXAiLCJsb2FkQXN5bmMiLCJlbnRyaWVzIiwiT2JqZWN0Iiwia2V5cyIsImZpbGVzIiwic29tZSIsIm5hbWUiLCJpbmNsdWRlcyIsImVuc3VyZVNoZWV0Iiwid29ya2Jvb2siLCJoZWFkZXJzIiwic2hlZXQiLCJnZXRXb3Jrc2hlZXQiLCJhZGRXb3Jrc2hlZXQiLCJhZGRSb3ciLCJyb3dDb3VudCIsImFwcGx5Q2FycnlPdmVyUnVsZXMiLCJtZXRyaWNzIiwicnVsZXMiLCJyZXN1bHQiLCJNYXAiLCJtYXAiLCJtIiwidmFsdWUiLCJhcHBsaWVkIiwiZm9yRWFjaCIsInJ1bGUiLCJzb3VyY2UiLCJnZXQiLCJzb3VyY2VNZXRyaWMiLCJ0YXJnZXQiLCJ0YXJnZXRNZXRyaWMiLCJ1bmRlZmluZWQiLCJwcmV2aW91cyIsIm5leHQiLCJvcGVyYXRpb24iLCJzZXQiLCJkZXNjcmlwdGlvbiIsImVmZmVjdGl2ZU1ldHJpY3MiLCJ1cGRhdGVXb3JrYm9vayIsInBhcmFtcyIsImNhc2VzIiwibWFwcGluZyIsIm1vbnRoIiwid29yZEhhc2giLCJleGNlbEhhc2giLCJjYXJyeU92ZXJSdWxlcyIsIldvcmtib29rIiwieGxzeCIsImxvYWQiLCJCdWZmZXIiLCJmcm9tIiwibWV0cmljTWFwIiwiYXVkaXRTaGVldCIsIm1ldHJpY05hbWUiLCJsb2NhdGlvbiIsIm1ldHJpYyIsImNlbGwiLCJnZXRDZWxsIiwicHJldlZhbHVlIiwibmV3VmFsdWUiLCJkZWx0YSIsInN1bW1hcnkiLCJzbmlwcGV0IiwibGVuZ3RoIiwiaXRlbSIsInN1bW1hcnlTaGVldCIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYXNlU2hlZXQiLCJyb3ciLCJzZWN0aW9uIiwibm9ybWFsaXplZCIsImxvZ1NoZWV0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwib3V0cHV0Iiwid3JpdGVCdWZmZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/excel.ts\n");

/***/ }),

/***/ "(rsc)/./lib/metrics.ts":
/*!************************!*\
  !*** ./lib/metrics.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractMetrics: () => (/* binding */ extractMetrics)\n/* harmony export */ });\nfunction parseNumber(raw) {\n    if (!raw) return null;\n    const cleaned = raw.replace(/\\s+/g, \"\").replace(/,/g, \".\");\n    if (!/^[-+]?\\d+(?:\\.\\d+)?$/.test(cleaned)) return null;\n    const num = Number(cleaned);\n    return Number.isFinite(num) ? num : null;\n}\nfunction extractMetrics(paragraphs, tables, dictionary) {\n    const metrics = [];\n    const duplicates = [];\n    for (const [name, def] of Object.entries(dictionary)){\n        const matches = [];\n        for (const paragraph of paragraphs){\n            for (const pattern of def.patterns){\n                const regex = new RegExp(pattern.regex, \"i\");\n                const match = paragraph.text.match(regex);\n                if (match && match[1]) {\n                    const value = parseNumber(match[1]);\n                    if (value !== null) {\n                        matches.push({\n                            name,\n                            value,\n                            source: {\n                                type: \"paragraph\",\n                                textSnippet: paragraph.text.slice(0, 160)\n                            }\n                        });\n                    }\n                }\n            }\n        }\n        tables.forEach((table, tableIndex)=>{\n            table.rows.forEach((row, rowIndex)=>{\n                row.forEach((cell, colIndex)=>{\n                    for (const pattern of def.patterns){\n                        const regex = new RegExp(pattern.regex, \"i\");\n                        const match = cell.match(regex);\n                        if (match && match[1]) {\n                            const value = parseNumber(match[1]);\n                            if (value !== null) {\n                                matches.push({\n                                    name,\n                                    value,\n                                    source: {\n                                        type: \"table\",\n                                        tableIndex,\n                                        row: rowIndex,\n                                        col: colIndex,\n                                        textSnippet: cell.slice(0, 160)\n                                    }\n                                });\n                            }\n                        }\n                    }\n                });\n            });\n        });\n        if (matches.length > 1) {\n            duplicates.push(name);\n        }\n        if (matches.length > 0) {\n            const chosen = matches[0];\n            metrics.push({\n                name,\n                value: chosen.value,\n                source: chosen.source\n            });\n        }\n    }\n    return {\n        metrics,\n        duplicates\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbWV0cmljcy50cyIsIm1hcHBpbmdzIjoiOzs7O0FBS0EsU0FBU0EsWUFBWUMsR0FBVztJQUM5QixJQUFJLENBQUNBLEtBQUssT0FBTztJQUNqQixNQUFNQyxVQUFVRCxJQUFJRSxPQUFPLENBQUMsUUFBUSxJQUFJQSxPQUFPLENBQUMsTUFBTTtJQUN0RCxJQUFJLENBQUMsdUJBQXVCQyxJQUFJLENBQUNGLFVBQVUsT0FBTztJQUNsRCxNQUFNRyxNQUFNQyxPQUFPSjtJQUNuQixPQUFPSSxPQUFPQyxRQUFRLENBQUNGLE9BQU9BLE1BQU07QUFDdEM7QUFFTyxTQUFTRyxlQUNkQyxVQUEyQixFQUMzQkMsTUFBbUIsRUFDbkJDLFVBQWtFO0lBRWxFLE1BQU1DLFVBQTBCLEVBQUU7SUFDbEMsTUFBTUMsYUFBdUIsRUFBRTtJQUUvQixLQUFLLE1BQU0sQ0FBQ0MsTUFBTUMsSUFBSSxJQUFJQyxPQUFPQyxPQUFPLENBQUNOLFlBQWE7UUFDcEQsTUFBTU8sVUFBeUIsRUFBRTtRQUNqQyxLQUFLLE1BQU1DLGFBQWFWLFdBQVk7WUFDbEMsS0FBSyxNQUFNVyxXQUFXTCxJQUFJTSxRQUFRLENBQUU7Z0JBQ2xDLE1BQU1DLFFBQVEsSUFBSUMsT0FBT0gsUUFBUUUsS0FBSyxFQUFFO2dCQUN4QyxNQUFNRSxRQUFRTCxVQUFVTSxJQUFJLENBQUNELEtBQUssQ0FBQ0Y7Z0JBQ25DLElBQUlFLFNBQVNBLEtBQUssQ0FBQyxFQUFFLEVBQUU7b0JBQ3JCLE1BQU1FLFFBQVExQixZQUFZd0IsS0FBSyxDQUFDLEVBQUU7b0JBQ2xDLElBQUlFLFVBQVUsTUFBTTt3QkFDbEJSLFFBQVFTLElBQUksQ0FBQzs0QkFDWGI7NEJBQ0FZOzRCQUNBRSxRQUFRO2dDQUFFQyxNQUFNO2dDQUFhQyxhQUFhWCxVQUFVTSxJQUFJLENBQUNNLEtBQUssQ0FBQyxHQUFHOzRCQUFLO3dCQUN6RTtvQkFDRjtnQkFDRjtZQUNGO1FBQ0Y7UUFFQXJCLE9BQU9zQixPQUFPLENBQUMsQ0FBQ0MsT0FBT0M7WUFDckJELE1BQU1FLElBQUksQ0FBQ0gsT0FBTyxDQUFDLENBQUNJLEtBQUtDO2dCQUN2QkQsSUFBSUosT0FBTyxDQUFDLENBQUNNLE1BQU1DO29CQUNqQixLQUFLLE1BQU1uQixXQUFXTCxJQUFJTSxRQUFRLENBQUU7d0JBQ2xDLE1BQU1DLFFBQVEsSUFBSUMsT0FBT0gsUUFBUUUsS0FBSyxFQUFFO3dCQUN4QyxNQUFNRSxRQUFRYyxLQUFLZCxLQUFLLENBQUNGO3dCQUN6QixJQUFJRSxTQUFTQSxLQUFLLENBQUMsRUFBRSxFQUFFOzRCQUNyQixNQUFNRSxRQUFRMUIsWUFBWXdCLEtBQUssQ0FBQyxFQUFFOzRCQUNsQyxJQUFJRSxVQUFVLE1BQU07Z0NBQ2xCUixRQUFRUyxJQUFJLENBQUM7b0NBQ1hiO29DQUNBWTtvQ0FDQUUsUUFBUTt3Q0FDTkMsTUFBTTt3Q0FDTks7d0NBQ0FFLEtBQUtDO3dDQUNMRyxLQUFLRDt3Q0FDTFQsYUFBYVEsS0FBS1AsS0FBSyxDQUFDLEdBQUc7b0NBQzdCO2dDQUNGOzRCQUNGO3dCQUNGO29CQUNGO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLElBQUliLFFBQVF1QixNQUFNLEdBQUcsR0FBRztZQUN0QjVCLFdBQVdjLElBQUksQ0FBQ2I7UUFDbEI7UUFFQSxJQUFJSSxRQUFRdUIsTUFBTSxHQUFHLEdBQUc7WUFDdEIsTUFBTUMsU0FBU3hCLE9BQU8sQ0FBQyxFQUFFO1lBQ3pCTixRQUFRZSxJQUFJLENBQUM7Z0JBQUViO2dCQUFNWSxPQUFPZ0IsT0FBT2hCLEtBQUs7Z0JBQUVFLFFBQVFjLE9BQU9kLE1BQU07WUFBQztRQUNsRTtJQUNGO0lBRUEsT0FBTztRQUFFaEI7UUFBU0M7SUFBVztBQUMvQiIsInNvdXJjZXMiOlsid2VicGFjazovL3JlcG9ydC1hc3Npc3RhbnQvLi9saWIvbWV0cmljcy50cz9hMzA4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhcnNlZE1ldHJpYywgU291cmNlSW5mbyB9IGZyb20gJ0AvbGliL3R5cGVzJztcbmltcG9ydCB0eXBlIHsgRG9jeFBhcmFncmFwaCwgRG9jeFRhYmxlIH0gZnJvbSAnQC9saWIvZG9jeCc7XG5cbmV4cG9ydCB0eXBlIE1ldHJpY01hdGNoID0geyBuYW1lOiBzdHJpbmc7IHZhbHVlOiBudW1iZXI7IHNvdXJjZTogU291cmNlSW5mbyB9O1xuXG5mdW5jdGlvbiBwYXJzZU51bWJlcihyYXc6IHN0cmluZyk6IG51bWJlciB8IG51bGwge1xuICBpZiAoIXJhdykgcmV0dXJuIG51bGw7XG4gIGNvbnN0IGNsZWFuZWQgPSByYXcucmVwbGFjZSgvXFxzKy9nLCAnJykucmVwbGFjZSgvLC9nLCAnLicpO1xuICBpZiAoIS9eWy0rXT9cXGQrKD86XFwuXFxkKyk/JC8udGVzdChjbGVhbmVkKSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IG51bSA9IE51bWJlcihjbGVhbmVkKTtcbiAgcmV0dXJuIE51bWJlci5pc0Zpbml0ZShudW0pID8gbnVtIDogbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RNZXRyaWNzKFxuICBwYXJhZ3JhcGhzOiBEb2N4UGFyYWdyYXBoW10sXG4gIHRhYmxlczogRG9jeFRhYmxlW10sXG4gIGRpY3Rpb25hcnk6IFJlY29yZDxzdHJpbmcsIHsgcGF0dGVybnM6IEFycmF5PHsgcmVnZXg6IHN0cmluZyB9PiB9PlxuKSB7XG4gIGNvbnN0IG1ldHJpY3M6IFBhcnNlZE1ldHJpY1tdID0gW107XG4gIGNvbnN0IGR1cGxpY2F0ZXM6IHN0cmluZ1tdID0gW107XG5cbiAgZm9yIChjb25zdCBbbmFtZSwgZGVmXSBvZiBPYmplY3QuZW50cmllcyhkaWN0aW9uYXJ5KSkge1xuICAgIGNvbnN0IG1hdGNoZXM6IE1ldHJpY01hdGNoW10gPSBbXTtcbiAgICBmb3IgKGNvbnN0IHBhcmFncmFwaCBvZiBwYXJhZ3JhcGhzKSB7XG4gICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZGVmLnBhdHRlcm5zKSB7XG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChwYXR0ZXJuLnJlZ2V4LCAnaScpO1xuICAgICAgICBjb25zdCBtYXRjaCA9IHBhcmFncmFwaC50ZXh0Lm1hdGNoKHJlZ2V4KTtcbiAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZU51bWJlcihtYXRjaFsxXSk7XG4gICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBtYXRjaGVzLnB1c2goe1xuICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgc291cmNlOiB7IHR5cGU6ICdwYXJhZ3JhcGgnLCB0ZXh0U25pcHBldDogcGFyYWdyYXBoLnRleHQuc2xpY2UoMCwgMTYwKSB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICB0YWJsZXMuZm9yRWFjaCgodGFibGUsIHRhYmxlSW5kZXgpID0+IHtcbiAgICAgIHRhYmxlLnJvd3MuZm9yRWFjaCgocm93LCByb3dJbmRleCkgPT4ge1xuICAgICAgICByb3cuZm9yRWFjaCgoY2VsbCwgY29sSW5kZXgpID0+IHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZGVmLnBhdHRlcm5zKSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybi5yZWdleCwgJ2knKTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gY2VsbC5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZU51bWJlcihtYXRjaFsxXSk7XG4gICAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG1hdGNoZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAgICAgICBzb3VyY2U6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3RhYmxlJyxcbiAgICAgICAgICAgICAgICAgICAgdGFibGVJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgcm93OiByb3dJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgY29sOiBjb2xJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgdGV4dFNuaXBwZXQ6IGNlbGwuc2xpY2UoMCwgMTYwKVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaWYgKG1hdGNoZXMubGVuZ3RoID4gMSkge1xuICAgICAgZHVwbGljYXRlcy5wdXNoKG5hbWUpO1xuICAgIH1cblxuICAgIGlmIChtYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGNob3NlbiA9IG1hdGNoZXNbMF07XG4gICAgICBtZXRyaWNzLnB1c2goeyBuYW1lLCB2YWx1ZTogY2hvc2VuLnZhbHVlLCBzb3VyY2U6IGNob3Nlbi5zb3VyY2UgfSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgbWV0cmljcywgZHVwbGljYXRlcyB9O1xufVxyXG5cclxuIl0sIm5hbWVzIjpbInBhcnNlTnVtYmVyIiwicmF3IiwiY2xlYW5lZCIsInJlcGxhY2UiLCJ0ZXN0IiwibnVtIiwiTnVtYmVyIiwiaXNGaW5pdGUiLCJleHRyYWN0TWV0cmljcyIsInBhcmFncmFwaHMiLCJ0YWJsZXMiLCJkaWN0aW9uYXJ5IiwibWV0cmljcyIsImR1cGxpY2F0ZXMiLCJuYW1lIiwiZGVmIiwiT2JqZWN0IiwiZW50cmllcyIsIm1hdGNoZXMiLCJwYXJhZ3JhcGgiLCJwYXR0ZXJuIiwicGF0dGVybnMiLCJyZWdleCIsIlJlZ0V4cCIsIm1hdGNoIiwidGV4dCIsInZhbHVlIiwicHVzaCIsInNvdXJjZSIsInR5cGUiLCJ0ZXh0U25pcHBldCIsInNsaWNlIiwiZm9yRWFjaCIsInRhYmxlIiwidGFibGVJbmRleCIsInJvd3MiLCJyb3ciLCJyb3dJbmRleCIsImNlbGwiLCJjb2xJbmRleCIsImNvbCIsImxlbmd0aCIsImNob3NlbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/metrics.ts\n");

/***/ }),

/***/ "(rsc)/./lib/month.ts":
/*!**********************!*\
  !*** ./lib/month.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   detectMonth: () => (/* binding */ detectMonth)\n/* harmony export */ });\nfunction detectMonth(paragraphs, filename) {\n    const candidates = new Set();\n    const regex = /(20\\d{2})[-/.](0[1-9]|1[0-2])/g;\n    const scan = (text)=>{\n        let match;\n        while((match = regex.exec(text)) !== null){\n            candidates.add(`${match[1]}-${match[2]}`);\n        }\n    };\n    paragraphs.forEach((p)=>scan(p.text));\n    if (filename) scan(filename);\n    const list = Array.from(candidates);\n    if (list.length === 1) return {\n        month: list[0],\n        candidates: list\n    };\n    return {\n        month: null,\n        candidates: list\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9udGgudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUVPLFNBQVNBLFlBQVlDLFVBQTJCLEVBQUVDLFFBQWlCO0lBQ3hFLE1BQU1DLGFBQWEsSUFBSUM7SUFDdkIsTUFBTUMsUUFBUTtJQUVkLE1BQU1DLE9BQU8sQ0FBQ0M7UUFDWixJQUFJQztRQUNKLE1BQU8sQ0FBQ0EsUUFBUUgsTUFBTUksSUFBSSxDQUFDRixLQUFJLE1BQU8sS0FBTTtZQUMxQ0osV0FBV08sR0FBRyxDQUFDLENBQUMsRUFBRUYsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUVBLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxQztJQUNGO0lBRUFQLFdBQVdVLE9BQU8sQ0FBQyxDQUFDQyxJQUFNTixLQUFLTSxFQUFFTCxJQUFJO0lBQ3JDLElBQUlMLFVBQVVJLEtBQUtKO0lBRW5CLE1BQU1XLE9BQU9DLE1BQU1DLElBQUksQ0FBQ1o7SUFDeEIsSUFBSVUsS0FBS0csTUFBTSxLQUFLLEdBQUcsT0FBTztRQUFFQyxPQUFPSixJQUFJLENBQUMsRUFBRTtRQUFFVixZQUFZVTtJQUFLO0lBQ2pFLE9BQU87UUFBRUksT0FBTztRQUFNZCxZQUFZVTtJQUFLO0FBQ3pDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVwb3J0LWFzc2lzdGFudC8uL2xpYi9tb250aC50cz9jMzc1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgRG9jeFBhcmFncmFwaCB9IGZyb20gJ0AvbGliL2RvY3gnO1xuXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0TW9udGgocGFyYWdyYXBoczogRG9jeFBhcmFncmFwaFtdLCBmaWxlbmFtZT86IHN0cmluZykge1xuICBjb25zdCBjYW5kaWRhdGVzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGNvbnN0IHJlZ2V4ID0gLygyMFxcZHsyfSlbLS8uXSgwWzEtOV18MVswLTJdKS9nO1xuXG4gIGNvbnN0IHNjYW4gPSAodGV4dDogc3RyaW5nKSA9PiB7XG4gICAgbGV0IG1hdGNoOiBSZWdFeHBFeGVjQXJyYXkgfCBudWxsO1xuICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgY2FuZGlkYXRlcy5hZGQoYCR7bWF0Y2hbMV19LSR7bWF0Y2hbMl19YCk7XG4gICAgfVxuICB9O1xuXG4gIHBhcmFncmFwaHMuZm9yRWFjaCgocCkgPT4gc2NhbihwLnRleHQpKTtcbiAgaWYgKGZpbGVuYW1lKSBzY2FuKGZpbGVuYW1lKTtcblxuICBjb25zdCBsaXN0ID0gQXJyYXkuZnJvbShjYW5kaWRhdGVzKTtcbiAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSByZXR1cm4geyBtb250aDogbGlzdFswXSwgY2FuZGlkYXRlczogbGlzdCB9O1xuICByZXR1cm4geyBtb250aDogbnVsbCwgY2FuZGlkYXRlczogbGlzdCB9O1xufVxyXG5cclxuIl0sIm5hbWVzIjpbImRldGVjdE1vbnRoIiwicGFyYWdyYXBocyIsImZpbGVuYW1lIiwiY2FuZGlkYXRlcyIsIlNldCIsInJlZ2V4Iiwic2NhbiIsInRleHQiLCJtYXRjaCIsImV4ZWMiLCJhZGQiLCJmb3JFYWNoIiwicCIsImxpc3QiLCJBcnJheSIsImZyb20iLCJsZW5ndGgiLCJtb250aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/month.ts\n");

/***/ }),

/***/ "(rsc)/./lib/validate.ts":
/*!*************************!*\
  !*** ./lib/validate.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   summarizeSource: () => (/* binding */ summarizeSource),\n/* harmony export */   validateAnalysis: () => (/* binding */ validateAnalysis)\n/* harmony export */ });\nfunction isValidMonth(value) {\n    return /^20\\d{2}-(0[1-9]|1[0-2])$/.test(value);\n}\nfunction formatLocation(source) {\n    if (!source?.type) return undefined;\n    if (source.type === \"paragraph\") return \"Paragraph\";\n    if (source.type === \"table\") {\n        return `Table ${source.tableIndex ?? 0} Row ${source.row ?? 0} Col ${source.col ?? 0}`;\n    }\n    return undefined;\n}\nfunction validateAnalysis(params) {\n    const { metrics, cases, requiredMetrics, metricCellMap, metricRules, crossChecks, caseRules, monthCandidates, monthOverride, duplicateMetrics = [], carryOverRules } = params;\n    const validations = [];\n    const metricMap = new Map(metrics.map((m)=>[\n            m.name,\n            m\n        ]));\n    const overrideProvided = typeof monthOverride === \"string\" && monthOverride.trim().length > 0;\n    const overrideValid = overrideProvided ? isValidMonth(monthOverride.trim()) : false;\n    const resolvedMonth = overrideValid ? monthOverride.trim() : monthCandidates.length === 1 ? monthCandidates[0] : null;\n    if (overrideProvided && !overrideValid) {\n        validations.push({\n            id: \"month-override\",\n            status: \"fail\",\n            message: \"Month override is invalid. Use YYYY-MM format.\"\n        });\n    }\n    if (!resolvedMonth) {\n        validations.push({\n            id: \"month-detection\",\n            status: \"fail\",\n            message: \"Month could not be resolved. Provide a manual override (YYYY-MM).\",\n            details: monthCandidates.length > 1 ? `Multiple candidates detected: ${monthCandidates.join(\", \")}` : \"No month found in report.\"\n        });\n    } else {\n        validations.push({\n            id: \"month-detection\",\n            status: \"pass\",\n            message: `Month resolved as ${resolvedMonth}.`\n        });\n    }\n    for (const name of requiredMetrics){\n        if (!metricMap.has(name)) {\n            validations.push({\n                id: `metric-required-${name}`,\n                status: \"fail\",\n                message: `Required metric missing: ${name}`\n            });\n        } else {\n            validations.push({\n                id: `metric-required-${name}`,\n                status: \"pass\",\n                message: `Required metric found: ${name}`\n            });\n        }\n    }\n    for (const name of requiredMetrics){\n        const mapping = metricCellMap[name];\n        const validCell = mapping && /^[A-Z]+[1-9][0-9]*$/.test(mapping.cell) && mapping.sheet.trim().length > 0;\n        if (!validCell) {\n            validations.push({\n                id: `mapping-${name}`,\n                status: \"fail\",\n                message: `Missing or invalid Excel cell mapping for ${name}.`\n            });\n        } else {\n            validations.push({\n                id: `mapping-${name}`,\n                status: \"pass\",\n                message: `Mapped ${name} to ${mapping.sheet}!${mapping.cell}.`\n            });\n        }\n    }\n    metrics.forEach((metric)=>{\n        const override = metricRules.overrides[metric.name] || {};\n        const min = override.min ?? metricRules.defaults.min;\n        const max = override.max ?? metricRules.defaults.max;\n        const allowNegative = override.allowNegative ?? metricRules.defaults.allowNegative;\n        const numeric = Number.isFinite(metric.value);\n        if (!numeric) {\n            validations.push({\n                id: `numeric-${metric.name}`,\n                status: \"fail\",\n                message: `Metric ${metric.name} is not numeric.`,\n                location: formatLocation(metric.source)\n            });\n            return;\n        }\n        if (!allowNegative && metric.value < 0) {\n            validations.push({\n                id: `bounds-${metric.name}`,\n                status: \"fail\",\n                message: `Metric ${metric.name} is negative (${metric.value}).`,\n                location: formatLocation(metric.source)\n            });\n            return;\n        }\n        if (metric.value < min || metric.value > max) {\n            validations.push({\n                id: `bounds-${metric.name}`,\n                status: \"fail\",\n                message: `Metric ${metric.name} is outside bounds (${min}-${max}).`,\n                location: formatLocation(metric.source)\n            });\n            return;\n        }\n        validations.push({\n            id: `bounds-${metric.name}`,\n            status: \"pass\",\n            message: `Metric ${metric.name} is within expected bounds.`\n        });\n    });\n    crossChecks.forEach((check, index)=>{\n        const total = metricMap.get(check.total);\n        const components = check.components.map((name)=>metricMap.get(name));\n        if (!total || components.some((c)=>!c)) {\n            validations.push({\n                id: `cross-check-${index}`,\n                status: \"fail\",\n                message: `Cross-check skipped: missing metric for ${check.reason}.`\n            });\n            return;\n        }\n        const sum = components.reduce((acc, metric)=>acc + (metric?.value ?? 0), 0);\n        if (sum !== total.value) {\n            validations.push({\n                id: `cross-check-${index}`,\n                status: \"fail\",\n                message: `Cross-check failed: ${check.reason}. Expected ${total.value}, got ${sum}.`\n            });\n        } else {\n            validations.push({\n                id: `cross-check-${index}`,\n                status: \"pass\",\n                message: `Cross-check passed: ${check.reason}.`\n            });\n        }\n    });\n    if (caseRules.caseCountMetric) {\n        const countMetric = metricMap.get(caseRules.caseCountMetric);\n        if (!countMetric) {\n            validations.push({\n                id: \"case-count-metric\",\n                status: \"fail\",\n                message: `Case count metric missing: ${caseRules.caseCountMetric}`\n            });\n        } else if (cases.length !== countMetric.value) {\n            validations.push({\n                id: \"case-count-metric\",\n                status: \"fail\",\n                message: `Case row count (${cases.length}) does not match ${caseRules.caseCountMetric} (${countMetric.value}).`\n            });\n        } else {\n            validations.push({\n                id: \"case-count-metric\",\n                status: \"pass\",\n                message: \"Case row count matches metric.\"\n            });\n        }\n    }\n    const seen = new Set();\n    let duplicateId = null;\n    let duplicateRow = null;\n    for (const row of cases){\n        const id = row.normalized[caseRules.caseIdField];\n        if (!id) continue;\n        if (seen.has(id)) {\n            duplicateId = id;\n            duplicateRow = row;\n            break;\n        }\n        seen.add(id);\n    }\n    if (duplicateId) {\n        validations.push({\n            id: \"case-duplicates\",\n            status: \"fail\",\n            message: `Duplicate case ID detected: ${duplicateId}.`,\n            location: `Table ${duplicateRow?.source.tableIndex ?? 0} Row ${duplicateRow?.source.row ?? 0}`\n        });\n    } else {\n        validations.push({\n            id: \"case-duplicates\",\n            status: \"pass\",\n            message: \"No duplicate case IDs detected.\"\n        });\n    }\n    if (duplicateMetrics.length > 0) {\n        validations.push({\n            id: \"metric-duplicates\",\n            status: \"fail\",\n            message: `Duplicate metric mentions found: ${duplicateMetrics.join(\", \")}`\n        });\n    } else {\n        validations.push({\n            id: \"metric-duplicates\",\n            status: \"pass\",\n            message: \"No duplicate metric mentions detected.\"\n        });\n    }\n    carryOverRules.forEach((rule, index)=>{\n        const source = metricMap.get(rule.sourceMetric);\n        const target = metricMap.get(rule.targetMetric);\n        if (!source || !target) {\n            validations.push({\n                id: `carry-over-${index}`,\n                status: \"fail\",\n                message: `Carry-over rule not satisfied: missing ${!source ? rule.sourceMetric : rule.targetMetric}.`,\n                details: rule.description\n            });\n        } else {\n            validations.push({\n                id: `carry-over-${index}`,\n                status: \"pass\",\n                message: `Carry-over rule ready: ${rule.description}`\n            });\n        }\n    });\n    const canGenerate = validations.every((v)=>v.status === \"pass\");\n    return {\n        validations,\n        resolvedMonth,\n        canGenerate\n    };\n}\nfunction summarizeSource(metric) {\n    return {\n        snippet: metric.source.textSnippet,\n        location: formatLocation(metric.source)\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBWVcsSUFBSSxDQUFDO1lBQ2ZDLElBQUk7WUFDSkMsUUFBUTtZQUNSQyxTQUFTO1FBQ1g7SUFDRjtJQUVBZixlQUFldUIsT0FBTyxDQUFDLENBQUNnQyxNQUFNbkI7UUFDNUIsTUFBTXRELFNBQVNvQixVQUFVb0MsR0FBRyxDQUFDaUIsS0FBS0MsWUFBWTtRQUM5QyxNQUFNQyxTQUFTdkQsVUFBVW9DLEdBQUcsQ0FBQ2lCLEtBQUtHLFlBQVk7UUFDOUMsSUFBSSxDQUFDNUUsVUFBVSxDQUFDMkUsUUFBUTtZQUN0QnhELFlBQVlXLElBQUksQ0FBQztnQkFDZkMsSUFBSSxDQUFDLFdBQVcsRUFBRXVCLE1BQU0sQ0FBQztnQkFDekJ0QixRQUFRO2dCQUNSQyxTQUFTLENBQUMsdUNBQXVDLEVBQUUsQ0FBQ2pDLFNBQVN5RSxLQUFLQyxZQUFZLEdBQUdELEtBQUtHLFlBQVksQ0FBQyxDQUFDLENBQUM7Z0JBQ3JHMUMsU0FBU3VDLEtBQUtJLFdBQVc7WUFDM0I7UUFDRixPQUFPO1lBQ0wxRCxZQUFZVyxJQUFJLENBQUM7Z0JBQ2ZDLElBQUksQ0FBQyxXQUFXLEVBQUV1QixNQUFNLENBQUM7Z0JBQ3pCdEIsUUFBUTtnQkFDUkMsU0FBUyxDQUFDLHVCQUF1QixFQUFFd0MsS0FBS0ksV0FBVyxDQUFDLENBQUM7WUFDdkQ7UUFDRjtJQUNGO0lBRUEsTUFBTUMsY0FBYzNELFlBQVk0RCxLQUFLLENBQUMsQ0FBQ0MsSUFBTUEsRUFBRWhELE1BQU0sS0FBSztJQUMxRCxPQUFPO1FBQUViO1FBQWFVO1FBQWVpRDtJQUFZO0FBQ25EO0FBRU8sU0FBU0csZ0JBQWdCdkMsTUFBb0I7SUFDbEQsT0FBTztRQUNMd0MsU0FBU3hDLE9BQU8xQyxNQUFNLENBQUNtRixXQUFXO1FBQ2xDL0IsVUFBVXJELGVBQWUyQyxPQUFPMUMsTUFBTTtJQUN4QztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVwb3J0LWFzc2lzdGFudC8uL2xpYi92YWxpZGF0ZS50cz85Zjc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhcnNlZENhc2VSb3csIFBhcnNlZE1ldHJpYywgVmFsaWRhdGlvblJlc3VsdCB9IGZyb20gJ0AvbGliL3R5cGVzJztcblxuZnVuY3Rpb24gaXNWYWxpZE1vbnRoKHZhbHVlOiBzdHJpbmcpIHtcbiAgcmV0dXJuIC9eMjBcXGR7Mn0tKDBbMS05XXwxWzAtMl0pJC8udGVzdCh2YWx1ZSk7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdExvY2F0aW9uKHNvdXJjZTogeyB0eXBlPzogc3RyaW5nOyB0YWJsZUluZGV4PzogbnVtYmVyOyByb3c/OiBudW1iZXI7IGNvbD86IG51bWJlciB9KSB7XG4gIGlmICghc291cmNlPy50eXBlKSByZXR1cm4gdW5kZWZpbmVkO1xuICBpZiAoc291cmNlLnR5cGUgPT09ICdwYXJhZ3JhcGgnKSByZXR1cm4gJ1BhcmFncmFwaCc7XG4gIGlmIChzb3VyY2UudHlwZSA9PT0gJ3RhYmxlJykge1xuICAgIHJldHVybiBgVGFibGUgJHtzb3VyY2UudGFibGVJbmRleCA/PyAwfSBSb3cgJHtzb3VyY2Uucm93ID8/IDB9IENvbCAke3NvdXJjZS5jb2wgPz8gMH1gO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUFuYWx5c2lzKHBhcmFtczoge1xuICBtZXRyaWNzOiBQYXJzZWRNZXRyaWNbXTtcbiAgY2FzZXM6IFBhcnNlZENhc2VSb3dbXTtcbiAgcmVxdWlyZWRNZXRyaWNzOiBzdHJpbmdbXTtcbiAgbWV0cmljQ2VsbE1hcDogUmVjb3JkPHN0cmluZywgeyBzaGVldDogc3RyaW5nOyBjZWxsOiBzdHJpbmcgfT47XG4gIG1ldHJpY1J1bGVzOiB7IGRlZmF1bHRzOiB7IG1pbjogbnVtYmVyOyBtYXg6IG51bWJlcjsgYWxsb3dOZWdhdGl2ZTogYm9vbGVhbiB9OyBvdmVycmlkZXM6IFJlY29yZDxzdHJpbmcsIHsgbWluPzogbnVtYmVyOyBtYXg/OiBudW1iZXI7IGFsbG93TmVnYXRpdmU/OiBib29sZWFuIH0+IH07XG4gIGNyb3NzQ2hlY2tzOiBBcnJheTx7IHRvdGFsOiBzdHJpbmc7IGNvbXBvbmVudHM6IHN0cmluZ1tdOyByZWFzb246IHN0cmluZyB9PjtcbiAgY2FzZVJ1bGVzOiB7IGNhc2VDb3VudE1ldHJpYzogc3RyaW5nOyBjYXNlSWRGaWVsZDogc3RyaW5nOyBkdXBsaWNhdGVQb2xpY3k6ICdmYWlsJyB8ICd3YXJuJyB9O1xuICBtb250aENhbmRpZGF0ZXM6IHN0cmluZ1tdO1xuICBtb250aE92ZXJyaWRlPzogc3RyaW5nIHwgbnVsbDtcbiAgZHVwbGljYXRlTWV0cmljcz86IHN0cmluZ1tdO1xuICBjYXJyeU92ZXJSdWxlczogQXJyYXk8eyBzb3VyY2VNZXRyaWM6IHN0cmluZzsgdGFyZ2V0TWV0cmljOiBzdHJpbmc7IG9wZXJhdGlvbjogJ2FkZCcgfCAncmVwbGFjZSc7IGRlc2NyaXB0aW9uOiBzdHJpbmcgfT47XG59KTogeyB2YWxpZGF0aW9uczogVmFsaWRhdGlvblJlc3VsdFtdOyByZXNvbHZlZE1vbnRoOiBzdHJpbmcgfCBudWxsOyBjYW5HZW5lcmF0ZTogYm9vbGVhbiB9IHtcbiAgY29uc3Qge1xuICAgIG1ldHJpY3MsXG4gICAgY2FzZXMsXG4gICAgcmVxdWlyZWRNZXRyaWNzLFxuICAgIG1ldHJpY0NlbGxNYXAsXG4gICAgbWV0cmljUnVsZXMsXG4gICAgY3Jvc3NDaGVja3MsXG4gICAgY2FzZVJ1bGVzLFxuICAgIG1vbnRoQ2FuZGlkYXRlcyxcbiAgICBtb250aE92ZXJyaWRlLFxuICAgIGR1cGxpY2F0ZU1ldHJpY3MgPSBbXSxcbiAgICBjYXJyeU92ZXJSdWxlc1xuICB9ID0gcGFyYW1zO1xuXG4gIGNvbnN0IHZhbGlkYXRpb25zOiBWYWxpZGF0aW9uUmVzdWx0W10gPSBbXTtcbiAgY29uc3QgbWV0cmljTWFwID0gbmV3IE1hcChtZXRyaWNzLm1hcCgobSkgPT4gW20ubmFtZSwgbV0pKTtcblxuICBjb25zdCBvdmVycmlkZVByb3ZpZGVkID0gdHlwZW9mIG1vbnRoT3ZlcnJpZGUgPT09ICdzdHJpbmcnICYmIG1vbnRoT3ZlcnJpZGUudHJpbSgpLmxlbmd0aCA+IDA7XG4gIGNvbnN0IG92ZXJyaWRlVmFsaWQgPSBvdmVycmlkZVByb3ZpZGVkID8gaXNWYWxpZE1vbnRoKG1vbnRoT3ZlcnJpZGUudHJpbSgpKSA6IGZhbHNlO1xuICBjb25zdCByZXNvbHZlZE1vbnRoID0gb3ZlcnJpZGVWYWxpZCA/IG1vbnRoT3ZlcnJpZGUhLnRyaW0oKSA6IG1vbnRoQ2FuZGlkYXRlcy5sZW5ndGggPT09IDEgPyBtb250aENhbmRpZGF0ZXNbMF0gOiBudWxsO1xuXG4gIGlmIChvdmVycmlkZVByb3ZpZGVkICYmICFvdmVycmlkZVZhbGlkKSB7XG4gICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICBpZDogJ21vbnRoLW92ZXJyaWRlJyxcbiAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgbWVzc2FnZTogJ01vbnRoIG92ZXJyaWRlIGlzIGludmFsaWQuIFVzZSBZWVlZLU1NIGZvcm1hdC4nXG4gICAgfSk7XG4gIH1cblxuICBpZiAoIXJlc29sdmVkTW9udGgpIHtcbiAgICB2YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgIGlkOiAnbW9udGgtZGV0ZWN0aW9uJyxcbiAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgbWVzc2FnZTogJ01vbnRoIGNvdWxkIG5vdCBiZSByZXNvbHZlZC4gUHJvdmlkZSBhIG1hbnVhbCBvdmVycmlkZSAoWVlZWS1NTSkuJyxcbiAgICAgIGRldGFpbHM6IG1vbnRoQ2FuZGlkYXRlcy5sZW5ndGggPiAxID8gYE11bHRpcGxlIGNhbmRpZGF0ZXMgZGV0ZWN0ZWQ6ICR7bW9udGhDYW5kaWRhdGVzLmpvaW4oJywgJyl9YCA6ICdObyBtb250aCBmb3VuZCBpbiByZXBvcnQuJ1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgaWQ6ICdtb250aC1kZXRlY3Rpb24nLFxuICAgICAgc3RhdHVzOiAncGFzcycsXG4gICAgICBtZXNzYWdlOiBgTW9udGggcmVzb2x2ZWQgYXMgJHtyZXNvbHZlZE1vbnRofS5gXG4gICAgfSk7XG4gIH1cblxuICBmb3IgKGNvbnN0IG5hbWUgb2YgcmVxdWlyZWRNZXRyaWNzKSB7XG4gICAgaWYgKCFtZXRyaWNNYXAuaGFzKG5hbWUpKSB7XG4gICAgICB2YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgaWQ6IGBtZXRyaWMtcmVxdWlyZWQtJHtuYW1lfWAsXG4gICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICBtZXNzYWdlOiBgUmVxdWlyZWQgbWV0cmljIG1pc3Npbmc6ICR7bmFtZX1gXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiBgbWV0cmljLXJlcXVpcmVkLSR7bmFtZX1gLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYFJlcXVpcmVkIG1ldHJpYyBmb3VuZDogJHtuYW1lfWBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGZvciAoY29uc3QgbmFtZSBvZiByZXF1aXJlZE1ldHJpY3MpIHtcbiAgICBjb25zdCBtYXBwaW5nID0gbWV0cmljQ2VsbE1hcFtuYW1lXTtcbiAgICBjb25zdCB2YWxpZENlbGwgPSBtYXBwaW5nICYmIC9eW0EtWl0rWzEtOV1bMC05XSokLy50ZXN0KG1hcHBpbmcuY2VsbCkgJiYgbWFwcGluZy5zaGVldC50cmltKCkubGVuZ3RoID4gMDtcbiAgICBpZiAoIXZhbGlkQ2VsbCkge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiBgbWFwcGluZy0ke25hbWV9YCxcbiAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgIG1lc3NhZ2U6IGBNaXNzaW5nIG9yIGludmFsaWQgRXhjZWwgY2VsbCBtYXBwaW5nIGZvciAke25hbWV9LmBcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgICAgaWQ6IGBtYXBwaW5nLSR7bmFtZX1gLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYE1hcHBlZCAke25hbWV9IHRvICR7bWFwcGluZy5zaGVldH0hJHttYXBwaW5nLmNlbGx9LmBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIG1ldHJpY3MuZm9yRWFjaCgobWV0cmljKSA9PiB7XG4gICAgY29uc3Qgb3ZlcnJpZGUgPSBtZXRyaWNSdWxlcy5vdmVycmlkZXNbbWV0cmljLm5hbWVdIHx8IHt9O1xuICAgIGNvbnN0IG1pbiA9IG92ZXJyaWRlLm1pbiA/PyBtZXRyaWNSdWxlcy5kZWZhdWx0cy5taW47XG4gICAgY29uc3QgbWF4ID0gb3ZlcnJpZGUubWF4ID8/IG1ldHJpY1J1bGVzLmRlZmF1bHRzLm1heDtcbiAgICBjb25zdCBhbGxvd05lZ2F0aXZlID0gb3ZlcnJpZGUuYWxsb3dOZWdhdGl2ZSA/PyBtZXRyaWNSdWxlcy5kZWZhdWx0cy5hbGxvd05lZ2F0aXZlO1xuICAgIGNvbnN0IG51bWVyaWMgPSBOdW1iZXIuaXNGaW5pdGUobWV0cmljLnZhbHVlKTtcbiAgICBpZiAoIW51bWVyaWMpIHtcbiAgICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgICBpZDogYG51bWVyaWMtJHttZXRyaWMubmFtZX1gLFxuICAgICAgICBzdGF0dXM6ICdmYWlsJyxcbiAgICAgICAgbWVzc2FnZTogYE1ldHJpYyAke21ldHJpYy5uYW1lfSBpcyBub3QgbnVtZXJpYy5gLFxuICAgICAgICBsb2NhdGlvbjogZm9ybWF0TG9jYXRpb24obWV0cmljLnNvdXJjZSlcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoIWFsbG93TmVnYXRpdmUgJiYgbWV0cmljLnZhbHVlIDwgMCkge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiBgYm91bmRzLSR7bWV0cmljLm5hbWV9YCxcbiAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgIG1lc3NhZ2U6IGBNZXRyaWMgJHttZXRyaWMubmFtZX0gaXMgbmVnYXRpdmUgKCR7bWV0cmljLnZhbHVlfSkuYCxcbiAgICAgICAgbG9jYXRpb246IGZvcm1hdExvY2F0aW9uKG1ldHJpYy5zb3VyY2UpXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKG1ldHJpYy52YWx1ZSA8IG1pbiB8fCBtZXRyaWMudmFsdWUgPiBtYXgpIHtcbiAgICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgICBpZDogYGJvdW5kcy0ke21ldHJpYy5uYW1lfWAsXG4gICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICBtZXNzYWdlOiBgTWV0cmljICR7bWV0cmljLm5hbWV9IGlzIG91dHNpZGUgYm91bmRzICgke21pbn0tJHttYXh9KS5gLFxuICAgICAgICBsb2NhdGlvbjogZm9ybWF0TG9jYXRpb24obWV0cmljLnNvdXJjZSlcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgIGlkOiBgYm91bmRzLSR7bWV0cmljLm5hbWV9YCxcbiAgICAgIHN0YXR1czogJ3Bhc3MnLFxuICAgICAgbWVzc2FnZTogYE1ldHJpYyAke21ldHJpYy5uYW1lfSBpcyB3aXRoaW4gZXhwZWN0ZWQgYm91bmRzLmBcbiAgICB9KTtcbiAgfSk7XG5cbiAgY3Jvc3NDaGVja3MuZm9yRWFjaCgoY2hlY2ssIGluZGV4KSA9PiB7XG4gICAgY29uc3QgdG90YWwgPSBtZXRyaWNNYXAuZ2V0KGNoZWNrLnRvdGFsKTtcbiAgICBjb25zdCBjb21wb25lbnRzID0gY2hlY2suY29tcG9uZW50cy5tYXAoKG5hbWUpID0+IG1ldHJpY01hcC5nZXQobmFtZSkpO1xuICAgIGlmICghdG90YWwgfHwgY29tcG9uZW50cy5zb21lKChjKSA9PiAhYykpIHtcbiAgICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgICBpZDogYGNyb3NzLWNoZWNrLSR7aW5kZXh9YCxcbiAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgIG1lc3NhZ2U6IGBDcm9zcy1jaGVjayBza2lwcGVkOiBtaXNzaW5nIG1ldHJpYyBmb3IgJHtjaGVjay5yZWFzb259LmBcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBzdW0gPSBjb21wb25lbnRzLnJlZHVjZSgoYWNjLCBtZXRyaWMpID0+IGFjYyArIChtZXRyaWM/LnZhbHVlID8/IDApLCAwKTtcbiAgICBpZiAoc3VtICE9PSB0b3RhbC52YWx1ZSkge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiBgY3Jvc3MtY2hlY2stJHtpbmRleH1gLFxuICAgICAgICBzdGF0dXM6ICdmYWlsJyxcbiAgICAgICAgbWVzc2FnZTogYENyb3NzLWNoZWNrIGZhaWxlZDogJHtjaGVjay5yZWFzb259LiBFeHBlY3RlZCAke3RvdGFsLnZhbHVlfSwgZ290ICR7c3VtfS5gXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiBgY3Jvc3MtY2hlY2stJHtpbmRleH1gLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYENyb3NzLWNoZWNrIHBhc3NlZDogJHtjaGVjay5yZWFzb259LmBcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgaWYgKGNhc2VSdWxlcy5jYXNlQ291bnRNZXRyaWMpIHtcbiAgICBjb25zdCBjb3VudE1ldHJpYyA9IG1ldHJpY01hcC5nZXQoY2FzZVJ1bGVzLmNhc2VDb3VudE1ldHJpYyk7XG4gICAgaWYgKCFjb3VudE1ldHJpYykge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiAnY2FzZS1jb3VudC1tZXRyaWMnLFxuICAgICAgICBzdGF0dXM6ICdmYWlsJyxcbiAgICAgICAgbWVzc2FnZTogYENhc2UgY291bnQgbWV0cmljIG1pc3Npbmc6ICR7Y2FzZVJ1bGVzLmNhc2VDb3VudE1ldHJpY31gXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKGNhc2VzLmxlbmd0aCAhPT0gY291bnRNZXRyaWMudmFsdWUpIHtcbiAgICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgICBpZDogJ2Nhc2UtY291bnQtbWV0cmljJyxcbiAgICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICAgIG1lc3NhZ2U6IGBDYXNlIHJvdyBjb3VudCAoJHtjYXNlcy5sZW5ndGh9KSBkb2VzIG5vdCBtYXRjaCAke2Nhc2VSdWxlcy5jYXNlQ291bnRNZXRyaWN9ICgke2NvdW50TWV0cmljLnZhbHVlfSkuYFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgICBpZDogJ2Nhc2UtY291bnQtbWV0cmljJyxcbiAgICAgICAgc3RhdHVzOiAncGFzcycsXG4gICAgICAgIG1lc3NhZ2U6ICdDYXNlIHJvdyBjb3VudCBtYXRjaGVzIG1ldHJpYy4nXG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gIGxldCBkdXBsaWNhdGVJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gIGxldCBkdXBsaWNhdGVSb3c6IFBhcnNlZENhc2VSb3cgfCBudWxsID0gbnVsbDtcbiAgZm9yIChjb25zdCByb3cgb2YgY2FzZXMpIHtcbiAgICBjb25zdCBpZCA9IHJvdy5ub3JtYWxpemVkW2Nhc2VSdWxlcy5jYXNlSWRGaWVsZF07XG4gICAgaWYgKCFpZCkgY29udGludWU7XG4gICAgaWYgKHNlZW4uaGFzKGlkKSkge1xuICAgICAgZHVwbGljYXRlSWQgPSBpZDtcbiAgICAgIGR1cGxpY2F0ZVJvdyA9IHJvdztcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBzZWVuLmFkZChpZCk7XG4gIH1cblxuICBpZiAoZHVwbGljYXRlSWQpIHtcbiAgICB2YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgIGlkOiAnY2FzZS1kdXBsaWNhdGVzJyxcbiAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgbWVzc2FnZTogYER1cGxpY2F0ZSBjYXNlIElEIGRldGVjdGVkOiAke2R1cGxpY2F0ZUlkfS5gLFxuICAgICAgbG9jYXRpb246IGBUYWJsZSAke2R1cGxpY2F0ZVJvdz8uc291cmNlLnRhYmxlSW5kZXggPz8gMH0gUm93ICR7ZHVwbGljYXRlUm93Py5zb3VyY2Uucm93ID8/IDB9YFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgaWQ6ICdjYXNlLWR1cGxpY2F0ZXMnLFxuICAgICAgc3RhdHVzOiAncGFzcycsXG4gICAgICBtZXNzYWdlOiAnTm8gZHVwbGljYXRlIGNhc2UgSURzIGRldGVjdGVkLidcbiAgICB9KTtcbiAgfVxuXG4gIGlmIChkdXBsaWNhdGVNZXRyaWNzLmxlbmd0aCA+IDApIHtcbiAgICB2YWxpZGF0aW9ucy5wdXNoKHtcbiAgICAgIGlkOiAnbWV0cmljLWR1cGxpY2F0ZXMnLFxuICAgICAgc3RhdHVzOiAnZmFpbCcsXG4gICAgICBtZXNzYWdlOiBgRHVwbGljYXRlIG1ldHJpYyBtZW50aW9ucyBmb3VuZDogJHtkdXBsaWNhdGVNZXRyaWNzLmpvaW4oJywgJyl9YFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgaWQ6ICdtZXRyaWMtZHVwbGljYXRlcycsXG4gICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgIG1lc3NhZ2U6ICdObyBkdXBsaWNhdGUgbWV0cmljIG1lbnRpb25zIGRldGVjdGVkLidcbiAgICB9KTtcbiAgfVxuXG4gIGNhcnJ5T3ZlclJ1bGVzLmZvckVhY2goKHJ1bGUsIGluZGV4KSA9PiB7XG4gICAgY29uc3Qgc291cmNlID0gbWV0cmljTWFwLmdldChydWxlLnNvdXJjZU1ldHJpYyk7XG4gICAgY29uc3QgdGFyZ2V0ID0gbWV0cmljTWFwLmdldChydWxlLnRhcmdldE1ldHJpYyk7XG4gICAgaWYgKCFzb3VyY2UgfHwgIXRhcmdldCkge1xuICAgICAgdmFsaWRhdGlvbnMucHVzaCh7XG4gICAgICAgIGlkOiBgY2Fycnktb3Zlci0ke2luZGV4fWAsXG4gICAgICAgIHN0YXR1czogJ2ZhaWwnLFxuICAgICAgICBtZXNzYWdlOiBgQ2Fycnktb3ZlciBydWxlIG5vdCBzYXRpc2ZpZWQ6IG1pc3NpbmcgJHshc291cmNlID8gcnVsZS5zb3VyY2VNZXRyaWMgOiBydWxlLnRhcmdldE1ldHJpY30uYCxcbiAgICAgICAgZGV0YWlsczogcnVsZS5kZXNjcmlwdGlvblxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHZhbGlkYXRpb25zLnB1c2goe1xuICAgICAgICBpZDogYGNhcnJ5LW92ZXItJHtpbmRleH1gLFxuICAgICAgICBzdGF0dXM6ICdwYXNzJyxcbiAgICAgICAgbWVzc2FnZTogYENhcnJ5LW92ZXIgcnVsZSByZWFkeTogJHtydWxlLmRlc2NyaXB0aW9ufWBcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgY2FuR2VuZXJhdGUgPSB2YWxpZGF0aW9ucy5ldmVyeSgodikgPT4gdi5zdGF0dXMgPT09ICdwYXNzJyk7XG4gIHJldHVybiB7IHZhbGlkYXRpb25zLCByZXNvbHZlZE1vbnRoLCBjYW5HZW5lcmF0ZSB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3VtbWFyaXplU291cmNlKG1ldHJpYzogUGFyc2VkTWV0cmljKSB7XG4gIHJldHVybiB7XG4gICAgc25pcHBldDogbWV0cmljLnNvdXJjZS50ZXh0U25pcHBldCxcbiAgICBsb2NhdGlvbjogZm9ybWF0TG9jYXRpb24obWV0cmljLnNvdXJjZSlcbiAgfTtcbn1cclxuXHJcbiJdLCJuYW1lcyI6WyJpc1ZhbGlkTW9udGgiLCJ2YWx1ZSIsInRlc3QiLCJmb3JtYXRMb2NhdGlvbiIsInNvdXJjZSIsInR5cGUiLCJ1bmRlZmluZWQiLCJ0YWJsZUluZGV4Iiwicm93IiwiY29sIiwidmFsaWRhdGVBbmFseXNpcyIsInBhcmFtcyIsIm1ldHJpY3MiLCJjYXNlcyIsInJlcXVpcmVkTWV0cmljcyIsIm1ldHJpY0NlbGxNYXAiLCJtZXRyaWNSdWxlcyIsImNyb3NzQ2hlY2tzIiwiY2FzZVJ1bGVzIiwibW9udGhDYW5kaWRhdGVzIiwibW9udGhPdmVycmlkZSIsImR1cGxpY2F0ZU1ldHJpY3MiLCJjYXJyeU92ZXJSdWxlcyIsInZhbGlkYXRpb25zIiwibWV0cmljTWFwIiwiTWFwIiwibWFwIiwibSIsIm5hbWUiLCJvdmVycmlkZVByb3ZpZGVkIiwidHJpbSIsImxlbmd0aCIsIm92ZXJyaWRlVmFsaWQiLCJyZXNvbHZlZE1vbnRoIiwicHVzaCIsImlkIiwic3RhdHVzIiwibWVzc2FnZSIsImRldGFpbHMiLCJqb2luIiwiaGFzIiwibWFwcGluZyIsInZhbGlkQ2VsbCIsImNlbGwiLCJzaGVldCIsImZvckVhY2giLCJtZXRyaWMiLCJvdmVycmlkZSIsIm92ZXJyaWRlcyIsIm1pbiIsImRlZmF1bHRzIiwibWF4IiwiYWxsb3dOZWdhdGl2ZSIsIm51bWVyaWMiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsImxvY2F0aW9uIiwiY2hlY2siLCJpbmRleCIsInRvdGFsIiwiZ2V0IiwiY29tcG9uZW50cyIsInNvbWUiLCJjIiwicmVhc29uIiwic3VtIiwicmVkdWNlIiwiYWNjIiwiY2FzZUNvdW50TWV0cmljIiwiY291bnRNZXRyaWMiLCJzZWVuIiwiU2V0IiwiZHVwbGljYXRlSWQiLCJkdXBsaWNhdGVSb3ciLCJub3JtYWxpemVkIiwiY2FzZUlkRmllbGQiLCJhZGQiLCJydWxlIiwic291cmNlTWV0cmljIiwidGFyZ2V0IiwidGFyZ2V0TWV0cmljIiwiZGVzY3JpcHRpb24iLCJjYW5HZW5lcmF0ZSIsImV2ZXJ5IiwidiIsInN1bW1hcml6ZVNvdXJjZSIsInNuaXBwZXQiLCJ0ZXh0U25pcHBldCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/validate.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/exceljs","vendor-chunks/jszip","vendor-chunks/bluebird","vendor-chunks/unzipper","vendor-chunks/@fast-csv","vendor-chunks/pako","vendor-chunks/uuid","vendor-chunks/readable-stream","vendor-chunks/fstream","vendor-chunks/lazystream","vendor-chunks/archiver-utils","vendor-chunks/fast-xml-parser","vendor-chunks/duplexer2","vendor-chunks/compress-commons","vendor-chunks/archiver","vendor-chunks/tar-stream","vendor-chunks/readdir-glob","vendor-chunks/graceful-fs","vendor-chunks/zip-stream","vendor-chunks/xmlchars","vendor-chunks/glob","vendor-chunks/dayjs","vendor-chunks/crc32-stream","vendor-chunks/inherits","vendor-chunks/fs.realpath","vendor-chunks/buffer-indexof-polyfill","vendor-chunks/bl","vendor-chunks/binary","vendor-chunks/async","vendor-chunks/wrappy","vendor-chunks/util-deprecate","vendor-chunks/traverse","vendor-chunks/tmp","vendor-chunks/strnum","vendor-chunks/string_decoder","vendor-chunks/saxes","vendor-chunks/safe-buffer","vendor-chunks/process-nextick-args","vendor-chunks/path-is-absolute","vendor-chunks/once","vendor-chunks/normalize-path","vendor-chunks/mkdirp","vendor-chunks/minimatch","vendor-chunks/lodash.uniq","vendor-chunks/lodash.union","vendor-chunks/lodash.isundefined","vendor-chunks/lodash.isplainobject","vendor-chunks/lodash.isnil","vendor-chunks/lodash.isfunction","vendor-chunks/lodash.isequal","vendor-chunks/lodash.isboolean","vendor-chunks/lodash.groupby","vendor-chunks/lodash.flatten","vendor-chunks/lodash.escaperegexp","vendor-chunks/lodash.difference","vendor-chunks/lodash.defaults","vendor-chunks/listenercount","vendor-chunks/lie","vendor-chunks/isarray","vendor-chunks/inflight","vendor-chunks/immediate","vendor-chunks/fs-constants","vendor-chunks/fast-csv","vendor-chunks/end-of-stream","vendor-chunks/crc-32","vendor-chunks/core-util-is","vendor-chunks/concat-map","vendor-chunks/chainsaw","vendor-chunks/buffers","vendor-chunks/buffer-crc32","vendor-chunks/brace-expansion","vendor-chunks/big-integer","vendor-chunks/balanced-match"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fanalyze%2Froute&page=%2Fapi%2Fanalyze%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fanalyze%2Froute.ts&appDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C1%5CDownloads%5CReport%20Assistant&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();